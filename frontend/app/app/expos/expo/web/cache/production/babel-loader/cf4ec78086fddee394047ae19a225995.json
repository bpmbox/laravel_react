{"ast":null,"code":"import _extends from\"@babel/runtime/helpers/extends\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import _ from'lodash';import PropTypes from'prop-types';import XDate from'xdate';import React,{Component}from'react';import Text from\"react-native-web/dist/exports/Text\";import SectionList from\"react-native-web/dist/exports/SectionList\";import{isToday}from\"../dateutils\";import{getMoment}from\"../momentResolver\";import styleConstructor from\"./style\";import asCalendarConsumer from\"./asCalendarConsumer\";var commons=require(\"./commons\");var updateSources=commons.UpdateSources;var AgendaList=function(_Component){_inherits(AgendaList,_Component);var _super=_createSuper(AgendaList);function AgendaList(){var _this;_classCallCheck(this,AgendaList);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.style=styleConstructor(_this.props.theme);_this._topSection=_.get(_this.props,'sections[0].title');_this.didScroll=false;_this.sectionScroll=false;_this.viewabilityConfig={itemVisiblePercentThreshold:20};_this.list=React.createRef();_this.sectionHeight=0;_this.onViewableItemsChanged=function(info){if(info!=null&&info.viewableItems&&!_this.sectionScroll){var topSection=_.get(info==null?void 0:info.viewableItems[0],'section.title');if(topSection&&topSection!==_this._topSection){_this._topSection=topSection;if(_this.didScroll&&!_this.props.avoidDateUpdates){_.invoke(_this.props.context,'setDate',_this._topSection,updateSources.LIST_DRAG);}}}};_this.onScroll=function(event){if(!_this.didScroll){_this.didScroll=true;}_.invoke(_this.props,'onScroll',event);};_this.onMomentumScrollBegin=function(event){_.invoke(_this.props.context,'setDisabled',true);_.invoke(_this.props,'onMomentumScrollBegin',event);};_this.onMomentumScrollEnd=function(event){_this.sectionScroll=false;_.invoke(_this.props.context,'setDisabled',false);_.invoke(_this.props,'onMomentumScrollEnd',event);};_this.onScrollToIndexFailed=function(info){if(_this.props.onScrollToIndexFailed){_this.props.onScrollToIndexFailed(info);}else{console.warn('onScrollToIndexFailed info: ',info);}};_this.onHeaderLayout=function(event){_this.sectionHeight=event.nativeEvent.layout.height;};_this.renderSectionHeader=function(info){var _info$section;var _this$props=_this.props,renderSectionHeader=_this$props.renderSectionHeader,sectionStyle=_this$props.sectionStyle;var title=info==null?void 0:(_info$section=info.section)==null?void 0:_info$section.title;if(renderSectionHeader){return renderSectionHeader(title);}return React.createElement(Text,{allowFontScaling:false,style:[_this.style.sectionText,sectionStyle],onLayout:_this.onHeaderLayout},_this.getSectionTitle(title));};_this.keyExtractor=function(item,index){var keyExtractor=_this.props.keyExtractor;return _.isFunction(keyExtractor)?keyExtractor(item,index):String(index);};return _this;}_createClass(AgendaList,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;var date=this.props.context.date;if(date!==this._topSection){setTimeout(function(){var sectionIndex=_this2.getSectionIndex(date);if(sectionIndex){_this2.scrollToSection(sectionIndex);}},500);}}},{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var _this$props$context=this.props.context,updateSource=_this$props$context.updateSource,date=_this$props$context.date;if(date!==prevProps.context.date){if(updateSource!==updateSources.LIST_DRAG&&updateSource!==updateSources.CALENDAR_INIT){var sectionIndex=this.getSectionIndex(date);if(sectionIndex){this.scrollToSection(sectionIndex);}}}}},{key:\"getSectionIndex\",value:function getSectionIndex(date){var i;_.map(this.props.sections,function(section,index){if(section.title===date){i=index;return;}});return i;}},{key:\"getSectionTitle\",value:function getSectionTitle(title){if(!title)return;var _this$props2=this.props,dayFormatter=_this$props2.dayFormatter,dayFormat=_this$props2.dayFormat,useMoment=_this$props2.useMoment,markToday=_this$props2.markToday;var sectionTitle=title;if(dayFormatter){sectionTitle=dayFormatter(title);}else if(dayFormat){if(useMoment){var moment=getMoment();sectionTitle=moment(title).format(dayFormat);}else{sectionTitle=new XDate(title).toString(dayFormat);}}if(markToday){var todayString=XDate.locales[XDate.defaultLocale].today||commons.todayString;var today=isToday(new XDate(title));sectionTitle=today?todayString+\", \"+sectionTitle:sectionTitle;}return sectionTitle;}},{key:\"scrollToSection\",value:function scrollToSection(sectionIndex){var _this$list;if((_this$list=this.list)!=null&&_this$list.current&&sectionIndex!==undefined){var _this$props3=this.props,sections=_this$props3.sections,_this$props3$viewOffs=_this$props3.viewOffset,viewOffset=_this$props3$viewOffs===void 0?0:_this$props3$viewOffs;this.sectionScroll=true;this._topSection=sections[sectionIndex].title;this.list.current.scrollToLocation({animated:true,sectionIndex:sectionIndex,itemIndex:0,viewPosition:0,viewOffset:(commons.isAndroid?this.sectionHeight:0)+viewOffset});}}},{key:\"render\",value:function render(){var props=_.omit(this.props,'context');return React.createElement(SectionList,_extends({},props,{ref:this.list,keyExtractor:this.keyExtractor,showsVerticalScrollIndicator:false,onViewableItemsChanged:this.onViewableItemsChanged,viewabilityConfig:this.viewabilityConfig,renderSectionHeader:this.renderSectionHeader,onScroll:this.onScroll,onMomentumScrollBegin:this.onMomentumScrollBegin,onMomentumScrollEnd:this.onMomentumScrollEnd,onScrollToIndexFailed:this.onScrollToIndexFailed}));}}]);return AgendaList;}(Component);AgendaList.displayName='AgendaList';AgendaList.propTypes={dayFormat:PropTypes.string,dayFormatter:PropTypes.func,useMoment:PropTypes.bool,markToday:PropTypes.bool,sectionStyle:PropTypes.oneOfType([PropTypes.object,PropTypes.number,PropTypes.array]),avoidDateUpdates:PropTypes.bool};AgendaList.defaultProps={dayFormat:'dddd, MMM d',stickySectionHeadersEnabled:true,markToday:true};export default asCalendarConsumer(AgendaList);","map":{"version":3,"sources":["/app/node_modules/react-native-calendars/src/expandableCalendar/agendaList.js"],"names":["_","PropTypes","XDate","React","Component","isToday","getMoment","styleConstructor","asCalendarConsumer","commons","require","updateSources","UpdateSources","AgendaList","style","props","theme","_topSection","get","didScroll","sectionScroll","viewabilityConfig","itemVisiblePercentThreshold","list","createRef","sectionHeight","onViewableItemsChanged","info","viewableItems","topSection","avoidDateUpdates","invoke","context","LIST_DRAG","onScroll","event","onMomentumScrollBegin","onMomentumScrollEnd","onScrollToIndexFailed","console","warn","onHeaderLayout","nativeEvent","layout","height","renderSectionHeader","sectionStyle","title","section","sectionText","getSectionTitle","keyExtractor","item","index","isFunction","String","date","setTimeout","sectionIndex","getSectionIndex","scrollToSection","prevProps","updateSource","CALENDAR_INIT","i","map","sections","dayFormatter","dayFormat","useMoment","markToday","sectionTitle","moment","format","toString","todayString","locales","defaultLocale","today","current","undefined","viewOffset","scrollToLocation","animated","itemIndex","viewPosition","isAndroid","omit","displayName","propTypes","string","func","bool","oneOfType","object","number","array","defaultProps","stickySectionHeadersEnabled"],"mappings":"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","sourcesContent":["import _ from 'lodash';\nimport PropTypes from 'prop-types';\nimport XDate from 'xdate';\nimport React, { Component } from 'react';\nimport { Text, SectionList } from 'react-native';\n// @ts-expect-error\nimport { isToday } from '../dateutils';\n// @ts-expect-error\nimport { getMoment } from '../momentResolver';\nimport styleConstructor from './style';\nimport asCalendarConsumer from './asCalendarConsumer';\nconst commons = require('./commons');\nconst updateSources = commons.UpdateSources;\n/**\n * @description: AgendaList component\n * @note: Should be wrapped with 'CalendarProvider'\n * @extends: SectionList\n * @example: https://github.com/wix/react-native-calendars/blob/master/example/src/screens/expandableCalendar.js\n */\nclass AgendaList extends Component {\n    static displayName = 'AgendaList';\n    static propTypes = {\n        // ...SectionList.propTypes,\n        /** day format in section title. Formatting values: http://arshaw.com/xdate/#Formatting */\n        dayFormat: PropTypes.string,\n        /** a function to custom format the section header's title */\n        dayFormatter: PropTypes.func,\n        /** whether to use moment.js for date string formatting\n         * (remember to pass 'dayFormat' with appropriate format, like 'dddd, MMM D') */\n        useMoment: PropTypes.bool,\n        /** whether to mark today's title with the \"Today, ...\" string. Default = true */\n        markToday: PropTypes.bool,\n        /** style passed to the section view */\n        sectionStyle: PropTypes.oneOfType([PropTypes.object, PropTypes.number, PropTypes.array]),\n        /** whether to block the date change in calendar (and calendar context provider) when agenda scrolls */\n        avoidDateUpdates: PropTypes.bool\n    };\n    static defaultProps = {\n        dayFormat: 'dddd, MMM d',\n        stickySectionHeadersEnabled: true,\n        markToday: true\n    };\n    style = styleConstructor(this.props.theme);\n    _topSection = _.get(this.props, 'sections[0].title');\n    didScroll = false;\n    sectionScroll = false;\n    viewabilityConfig = {\n        itemVisiblePercentThreshold: 20 // 50 means if 50% of the item is visible\n    };\n    list = React.createRef();\n    sectionHeight = 0;\n    componentDidMount() {\n        const { date } = this.props.context;\n        if (date !== this._topSection) {\n            setTimeout(() => {\n                const sectionIndex = this.getSectionIndex(date);\n                if (sectionIndex) {\n                    this.scrollToSection(sectionIndex);\n                }\n            }, 500);\n        }\n    }\n    componentDidUpdate(prevProps) {\n        const { updateSource, date } = this.props.context;\n        if (date !== prevProps.context.date) {\n            // NOTE: on first init data should set first section to the current date!!!\n            if (updateSource !== updateSources.LIST_DRAG && updateSource !== updateSources.CALENDAR_INIT) {\n                const sectionIndex = this.getSectionIndex(date);\n                if (sectionIndex) {\n                    this.scrollToSection(sectionIndex);\n                }\n            }\n        }\n    }\n    getSectionIndex(date) {\n        let i;\n        _.map(this.props.sections, (section, index) => {\n            // NOTE: sections titles should match current date format!!!\n            if (section.title === date) {\n                i = index;\n                return;\n            }\n        });\n        return i;\n    }\n    getSectionTitle(title) {\n        if (!title)\n            return;\n        const { dayFormatter, dayFormat, useMoment, markToday } = this.props;\n        let sectionTitle = title;\n        if (dayFormatter) {\n            sectionTitle = dayFormatter(title);\n        }\n        else if (dayFormat) {\n            if (useMoment) {\n                const moment = getMoment();\n                sectionTitle = moment(title).format(dayFormat);\n            }\n            else {\n                sectionTitle = new XDate(title).toString(dayFormat);\n            }\n        }\n        if (markToday) {\n            // @ts-expect-error\n            const todayString = XDate.locales[XDate.defaultLocale].today || commons.todayString;\n            const today = isToday(new XDate(title));\n            sectionTitle = today ? `${todayString}, ${sectionTitle}` : sectionTitle;\n        }\n        return sectionTitle;\n    }\n    scrollToSection(sectionIndex) {\n        if (this.list?.current && sectionIndex !== undefined) {\n            const { sections, viewOffset = 0 } = this.props;\n            this.sectionScroll = true; // to avoid setDate() in onViewableItemsChanged\n            this._topSection = sections[sectionIndex].title;\n            this.list.current.scrollToLocation({\n                animated: true,\n                sectionIndex: sectionIndex,\n                itemIndex: 0,\n                viewPosition: 0,\n                viewOffset: (commons.isAndroid ? this.sectionHeight : 0) + viewOffset\n            });\n        }\n    }\n    onViewableItemsChanged = ((info) => {\n        if (info?.viewableItems && !this.sectionScroll) {\n            const topSection = _.get(info?.viewableItems[0], 'section.title');\n            if (topSection && topSection !== this._topSection) {\n                this._topSection = topSection;\n                if (this.didScroll && !this.props.avoidDateUpdates) {\n                    // to avoid setDate() on first load (while setting the initial context.date value)\n                    _.invoke(this.props.context, 'setDate', this._topSection, updateSources.LIST_DRAG);\n                }\n            }\n        }\n    });\n    onScroll = (event) => {\n        if (!this.didScroll) {\n            this.didScroll = true;\n        }\n        _.invoke(this.props, 'onScroll', event);\n    };\n    onMomentumScrollBegin = (event) => {\n        _.invoke(this.props.context, 'setDisabled', true);\n        _.invoke(this.props, 'onMomentumScrollBegin', event);\n    };\n    onMomentumScrollEnd = (event) => {\n        // when list momentum ends AND when scrollToSection scroll ends\n        this.sectionScroll = false;\n        _.invoke(this.props.context, 'setDisabled', false);\n        _.invoke(this.props, 'onMomentumScrollEnd', event);\n    };\n    onScrollToIndexFailed = (info) => {\n        if (this.props.onScrollToIndexFailed) {\n            this.props.onScrollToIndexFailed(info);\n        }\n        else {\n            console.warn('onScrollToIndexFailed info: ', info);\n        }\n    };\n    onHeaderLayout = (event) => {\n        this.sectionHeight = event.nativeEvent.layout.height;\n    };\n    renderSectionHeader = (info) => {\n        const { renderSectionHeader, sectionStyle } = this.props;\n        const title = info?.section?.title;\n        if (renderSectionHeader) {\n            return renderSectionHeader(title);\n        }\n        return (<Text allowFontScaling={false} style={[this.style.sectionText, sectionStyle]} onLayout={this.onHeaderLayout}>\n        {this.getSectionTitle(title)}\n      </Text>);\n    };\n    keyExtractor = (item, index) => {\n        const { keyExtractor } = this.props;\n        return _.isFunction(keyExtractor) ? keyExtractor(item, index) : String(index);\n    };\n    render() {\n        const props = _.omit(this.props, 'context');\n        return (<SectionList {...props} ref={this.list} keyExtractor={this.keyExtractor} showsVerticalScrollIndicator={false} onViewableItemsChanged={this.onViewableItemsChanged} viewabilityConfig={this.viewabilityConfig} renderSectionHeader={this.renderSectionHeader} onScroll={this.onScroll} onMomentumScrollBegin={this.onMomentumScrollBegin} onMomentumScrollEnd={this.onMomentumScrollEnd} onScrollToIndexFailed={this.onScrollToIndexFailed}/>);\n    }\n}\nexport default asCalendarConsumer(AgendaList);\n"]},"metadata":{},"sourceType":"module"}