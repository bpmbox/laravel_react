{"ast":null,"code":"\"use strict\";var _classCallCheck=require(\"@babel/runtime/helpers/classCallCheck\");var _createClass=require(\"@babel/runtime/helpers/createClass\");Object.defineProperty(exports,\"__esModule\",{value:true});exports.default=void 0;var _lookupRecord=_interopRequireDefault(require(\"../helpers/lookupRecord\"));var _BRRenderer=_interopRequireDefault(require(\"../renderers/BRRenderer\"));var _WBRRenderer=_interopRequireDefault(require(\"../renderers/WBRRenderer\"));var _internalRenderers=_interopRequireDefault(require(\"./internalRenderers\"));function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function _defineProperty(obj,key,value){if(key in obj){Object.defineProperty(obj,key,{value:value,enumerable:true,configurable:true,writable:true});}else{obj[key]=value;}return obj;}var internalTextRenderers={br:_BRRenderer.default,wbr:_WBRRenderer.default};var RenderRegistry=function(){function RenderRegistry(){var customRenderers=arguments.length>0&&arguments[0]!==undefined?arguments[0]:{};var elementModels=arguments.length>1?arguments[1]:undefined;_classCallCheck(this,RenderRegistry);_defineProperty(this,\"customRenderers\",{});_defineProperty(this,\"elementModels\",void 0);this.customRenderers=customRenderers;this.elementModels=elementModels;}_createClass(RenderRegistry,[{key:\"getInternalTextRenderer\",value:function getInternalTextRenderer(tagName){if((0,_lookupRecord.default)(internalTextRenderers,tagName)){return internalTextRenderers[tagName];}return null;}},{key:\"getRendererConfigForTNode\",value:function getRendererConfigForTNode(tnode){return{Custom:this.getCustomRendererForTNode(tnode),Default:this.getDefaultRendererForTNode(tnode)};}},{key:\"getDefaultRendererForTNode\",value:function getDefaultRendererForTNode(tnode){if(tnode.tagName in _internalRenderers.default){return _internalRenderers.default[tnode.tagName];}return null;}},{key:\"getCustomRendererForTNode\",value:function getCustomRendererForTNode(tnode){if(tnode.tagName in this.customRenderers){var renderer=this.customRenderers[tnode.tagName];if(__DEV__){var elementModel=this.elementModels[tnode.tagName];if(!elementModel){console.warn(\"You are attempting to render a \"+tnode.tagName+\" tag but you didn't provide an HTMLElementModel. Make sure you register a model for this tag in \\\"customHTMLElementModels\\\" prop. \");}else if(!tnode.matchContentModel(elementModel.contentModel)){console.warn(\"You are attempting to render \\\"\"+tnode.tagName+\"\\\" of type \\\"\"+tnode.displayName+\"\\\", but the registered renderer is of content model type \"+(elementModel===null||elementModel===void 0?void 0:elementModel.contentModel)+\" which is incompatible with \\\"\"+tnode.displayName+\"\\\".\");}}return renderer;}return null;}}]);return RenderRegistry;}();exports.default=RenderRegistry;","map":{"version":3,"sources":["RenderRegistry.ts"],"names":["internalTextRenderers","br","BRRenderer","wbr","WBRRenderer","constructor","customRenderers","Custom","Default","tnode","internalRenderers","renderer","elementModel","console","tagName","displayName","contentModel"],"mappings":"iOAGA,GAAA,CAAA,aAAA,CAAA,sBAAA,CAAA,OAAA,2BAAA,CAAA,CACA,GAAA,CAAA,WAAA,CAAA,sBAAA,CAAA,OAAA,2BAAA,CAAA,CACA,GAAA,CAAA,YAAA,CAAA,sBAAA,CAAA,OAAA,4BAAA,CAAA,CAMA,GAAA,CAAA,kBAAA,CAAA,sBAAA,CAAA,OAAA,uBAAA,CAAA,C,yQAMA,GAAMA,CAAAA,qBAAkE,CAAG,CACzEC,EAAE,CAAEC,WAAAA,CADqE,OAAA,CAEzEC,GAAG,CAAEC,YAAAA,CAAAA,OAFoE,CAA3E,C,GAUe,CAAA,c,YAIbC,yBAGE,IAFAC,CAAAA,eAEA,2DAHS,EAGT,IAHS,CAAA,aAGT,gFAAA,eAAA,CAAA,IAAA,CAAA,iBAAA,CAN0D,EAM1D,CAAA,CAAA,eAAA,CAAA,IAAA,CAAA,eAAA,CAAA,IAAA,EAAA,CAAA,CACA,KAAA,eAAA,CAAA,eAAA,CACA,KAAA,aAAA,CAAA,aAAA,CACD,C,mGAEsB,O,CAAyB,CAC9C,GAAI,CAAA,EAAA,aAAA,CAAA,OAAA,EAAA,qBAAA,CAAJ,OAAI,CAAJ,CAAkD,CAChD,MAAON,CAAAA,qBAAqB,CAA5B,OAA4B,CAA5B,CACD,CACD,MAAA,KAAA,CACD,C,4EAEwB,K,CAA+C,CACtE,MAAO,CACLO,MAAM,CAAE,KAAA,yBAAA,CADH,KACG,CADH,CAELC,OAAO,CAAE,KAAA,0BAAA,CAAA,KAAA,CAFJ,CAAP,CAID,C,8EAEiC,K,CAEJ,CAC5B,GAAIC,KAAK,CAALA,OAAAA,GAAkBC,CAAAA,kBAAAA,CAAtB,OAAA,CAAyC,CAEvC,MAAOA,CAAAA,kBAAAA,CAAAA,OAAAA,CAAkBD,KAAK,CAA9B,OAAOC,CAAP,CACD,CACD,MAAA,KAAA,CACD,C,4EAEgC,K,CAEe,CAC9C,GAAID,KAAK,CAALA,OAAAA,GAAkB,MAAtB,eAAA,CAA4C,CAC1C,GAAME,CAAAA,QAAQ,CAAG,KAAA,eAAA,CAAqBF,KAAK,CAA3C,OAAiB,CAAjB,CAEA,GAAA,OAAA,CAAa,CAEX,GAAMG,CAAAA,YAAY,CAAG,KAAA,aAAA,CAAmBH,KAAK,CAA7C,OAAqB,CAArB,CACA,GAAI,CAAJ,YAAA,CAAmB,CACjBI,OAAO,CAAPA,IAAAA,mCACoCJ,KAAK,CADzCI,OAAAA,uIADF,CAAA,IAIO,IAAI,CAACJ,KAAK,CAALA,iBAAAA,CAAwBG,YAAY,CAAzC,YAAKH,CAAL,CAAyD,CAC9DI,OAAO,CAAPA,IAAAA,mCACmCJ,KAAK,CAACK,OADzCD,iBAC8DJ,KAAK,CAACM,WADpEF,8DAC0ID,YAAxI,GAAA,IAAwIA,EAAAA,YAAxI,GAAA,IAAA,EAAwIA,CAAxI,IAAA,EAAwIA,CAAAA,YAAY,CAAEI,YADxJH,mCACoMJ,KAAK,CADzMI,WAAAA,QAGD,CACF,CACD,MAAA,CAAA,QAAA,CACD,CACD,MAAA,KAAA,CACD,C","sourcesContent":["import { TNode } from '@native-html/transient-render-engine';\nimport { ComponentType } from 'react';\nimport { CustomRendererProps } from '..';\nimport lookupRecord from '../helpers/lookupRecord';\nimport BRRenderer from '../renderers/BRRenderer';\nimport WBRRenderer from '../renderers/WBRRenderer';\nimport {\n  CustomRenderer,\n  HTMLElementModelRecord,\n  InternalRenderer\n} from '../shared-types';\nimport internalRenderers from './internalRenderers';\nimport {\n  CustomTagRendererRecord,\n  InternalTextContentRenderer\n} from './render-types';\n\nconst internalTextRenderers: Record<string, InternalTextContentRenderer> = {\n  br: BRRenderer,\n  wbr: WBRRenderer\n};\n\nexport interface RendererConfig<T extends TNode> {\n  Default: InternalRenderer<T> | null;\n  Custom: CustomRenderer<T> | null;\n}\n\nexport default class RenderRegistry {\n  private readonly customRenderers: CustomTagRendererRecord = {};\n  private readonly elementModels: HTMLElementModelRecord;\n\n  constructor(\n    customRenderers: CustomTagRendererRecord = {},\n    elementModels: HTMLElementModelRecord\n  ) {\n    this.customRenderers = customRenderers;\n    this.elementModels = elementModels;\n  }\n\n  getInternalTextRenderer(tagName: string | null) {\n    if (lookupRecord(internalTextRenderers, tagName)) {\n      return internalTextRenderers[tagName];\n    }\n    return null;\n  }\n\n  getRendererConfigForTNode<T extends TNode>(tnode: T): RendererConfig<T> {\n    return {\n      Custom: this.getCustomRendererForTNode(tnode),\n      Default: this.getDefaultRendererForTNode(tnode)\n    };\n  }\n\n  private getDefaultRendererForTNode<T extends TNode>(\n    tnode: T\n  ): InternalRenderer<T> | null {\n    if (tnode.tagName! in internalRenderers) {\n      //@ts-ignore\n      return internalRenderers[tnode.tagName!];\n    }\n    return null;\n  }\n\n  private getCustomRendererForTNode<T extends TNode>(\n    tnode: T\n  ): ComponentType<CustomRendererProps<T>> | null {\n    if (tnode.tagName! in this.customRenderers) {\n      const renderer = this.customRenderers[tnode.tagName!];\n      /* istanbul ignore next */\n      if (__DEV__) {\n        // In DEV, check for discrepancies.\n        const elementModel = this.elementModels[tnode.tagName!];\n        if (!elementModel) {\n          console.warn(\n            `You are attempting to render a ${tnode.tagName!} tag but you didn't provide an HTMLElementModel. Make sure you register a model for this tag in \"customHTMLElementModels\" prop. `\n          );\n        } else if (!tnode.matchContentModel(elementModel.contentModel)) {\n          console.warn(\n            `You are attempting to render \"${tnode.tagName}\" of type \"${tnode.displayName}\", but the registered renderer is of content model type ${elementModel?.contentModel} which is incompatible with \"${tnode.displayName}\".`\n          );\n        }\n      }\n      return renderer as any;\n    }\n    return null;\n  }\n}\n"]},"metadata":{},"sourceType":"script"}