{"ast":null,"code":"import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import firebase from'firebase';var FirebaseStorage=function(){function FirebaseStorage(){var _this=this;_classCallCheck(this,FirebaseStorage);this.initd=function(){if(!firebase.apps.length){firebase.initializeApp({apiKey:\"AIzaSyDZJZm9TgdBItFu1agAWryuKHWXv8og4pE\",authDomain:\"stachka-example.firebaseapp.com\",databaseURL:\"https://stachka-example.firebaseio.com\",projectId:\"stachka-example\",storageBucket:\"stachka-example.appspot.com\",messagingSenderId:\"907316643379\"});}};this.init=function(){if(!firebase.apps.length){alert(firebase.apps.length);firebase.initializeApp({apiKey:\"AIzaSyCsOjFyAAuFr1CITcnufG-GpZBKpLgUP90\",authDomain:\"rpa999-56929.firebaseapp.com\",databaseURL:\"https://rpa999-56929.firebaseio.com\",projectId:\"rpa999-56929\",storageBucket:\"rpa999-56929.appspot.com\",messagingSenderId:\"155298248089\",appId:\"1:155298248089:web:e25d64dc9f5370c4\"});}};this.observeAuth=function(){return firebase.auth().onAuthStateChanged(_this.onAuthStateChanged);};this.onAuthStateChanged=function(user){if(!user){try{firebase.auth().signInAnonymously();}catch(_ref){var message=_ref.message;alert(message);}}};this.parse=function(snapshot){console.log(\"line 50\");console.log(snapshot);var _snapshot$val=snapshot.val(),numberStamp=_snapshot$val.timestamp,text=_snapshot$val.text,user=_snapshot$val.user;var _id=snapshot.key;var timestamp=new Date(numberStamp);var message={_id:_id,timestamp:timestamp,text:text,user:user,aaaaaaaaa:1111111111111111111};return message;};this.on=function(callback){return _this.ref.limitToLast(20).on('child_added',function(snapshot){return callback(_this.parse(snapshot));});};this.send=function(messages){for(var i=0;i<messages.length;i++){var _messages$i=messages[i],text=_messages$i.text,user=_messages$i.user;var message={text:text,user:user,timestamp:_this.timestamp,teset:1111111111111111111111111111};_this.append(message);}};this.append=function(message){return _this.ref.push(message);};this.init();this.observeAuth();}_createClass(FirebaseStorage,[{key:\"off\",value:function off(){this.ref.off();}},{key:\"uid\",get:function get(){return(firebase.auth().currentUser||{}).uid;}},{key:\"ref\",get:function get(){return firebase.database().ref('messages');}},{key:\"timestamp\",get:function get(){return firebase.database.ServerValue.TIMESTAMP;}}]);return FirebaseStorage;}();FirebaseStorage.shared=new FirebaseStorage();export default FirebaseStorage;","map":{"version":3,"sources":["/app/p0005/data/FirebaseStorage.js"],"names":["firebase","FirebaseStorage","initd","apps","length","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","init","alert","appId","observeAuth","auth","onAuthStateChanged","user","signInAnonymously","message","parse","snapshot","console","log","val","numberStamp","timestamp","text","_id","key","Date","aaaaaaaaa","on","callback","ref","limitToLast","send","messages","i","teset","append","push","off","currentUser","uid","database","ServerValue","TIMESTAMP","shared"],"mappings":"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","sourcesContent":["import firebase from 'firebase'; // 4.8.1\n\nclass FirebaseStorage {\n\n  constructor() {\n    this.init();\n    this.observeAuth();\n  }\n\n  initd = () => {\n    if (!firebase.apps.length) {\n        firebase.initializeApp({\n          apiKey: \"AIzaSyDZJZm9TgdBItFu1agAWryuKHWXv8og4pE\",\n          authDomain: \"stachka-example.firebaseapp.com\",\n          databaseURL: \"https://stachka-example.firebaseio.com\",\n          projectId: \"stachka-example\",\n          storageBucket: \"stachka-example.appspot.com\",\n          messagingSenderId: \"907316643379\"\n      });\n    }\n  }\n  init = () => {\n    //alert(firebase.apps.length)\n    if (!firebase.apps.length) {\n      alert(firebase.apps.length)\n        firebase.initializeApp({\n    apiKey: \"AIzaSyCsOjFyAAuFr1CITcnufG-GpZBKpLgUP90\",\n  authDomain: \"rpa999-56929.firebaseapp.com\",\n  databaseURL: \"https://rpa999-56929.firebaseio.com\",\n  projectId: \"rpa999-56929\",\n  storageBucket: \"rpa999-56929.appspot.com\",\n  messagingSenderId: \"155298248089\",\n  appId: \"1:155298248089:web:e25d64dc9f5370c4\"\n   });\n    }\n  }\n\n  observeAuth = () =>\n    firebase.auth().onAuthStateChanged(this.onAuthStateChanged);\n\n  onAuthStateChanged = user => {\n    if (!user) {\n      try {\n        firebase.auth().signInAnonymously();\n      } catch ({ message }) {\n        alert(message);\n      }\n    }\n  };\n\n  get uid() {\n    return (firebase.auth().currentUser || {}).uid;\n  }\n\n  get ref() {\n    return firebase.database().ref('messages');\n  }\n\n  parse = snapshot => {\n    console.log(\"line 50\")\n    console.log(snapshot)\n    let { timestamp: numberStamp, text, user } = snapshot.val();//val text で設定\n    //text = JSON.stringify(snapshot)//text + \"chinko\";\n    const { key: _id } = snapshot;\n    const timestamp = new Date(numberStamp);\n    const message = {\n      _id,\n      timestamp,\n      text,\n      user,\n      aaaaaaaaa:1111111111111111111\n    };\n    return message;\n  };\n\n  on = callback =>\n    this.ref\n      .limitToLast(20)\n      .on('child_added', snapshot => callback(this.parse(snapshot)));\n\n  get timestamp() {\n    return firebase.database.ServerValue.TIMESTAMP;\n  }\n  \n  send = messages => {\n    for (let i = 0; i < messages.length; i++) {\n      const { text, user } = messages[i];\n      const message = {\n        text,\n        user,\n        timestamp: this.timestamp,\n        teset:1111111111111111111111111111\n      };\n      this.append(message);\n    }\n  };\n\n  append = message => this.ref.push(message);\n\n  off() {\n    this.ref.off();\n  }\n}\n\nFirebaseStorage.shared = new FirebaseStorage();\nexport default FirebaseStorage;\n"]},"metadata":{},"sourceType":"module"}