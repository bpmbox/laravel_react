{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _extends from\"@babel/runtime/helpers/extends\";import _objectWithoutProperties from\"@babel/runtime/helpers/objectWithoutProperties\";import _toConsumableArray from\"@babel/runtime/helpers/toConsumableArray\";import _classCallCheck from\"@babel/runtime/helpers/classCallCheck\";import _createClass from\"@babel/runtime/helpers/createClass\";import _assertThisInitialized from\"@babel/runtime/helpers/assertThisInitialized\";import _inherits from\"@babel/runtime/helpers/inherits\";import _possibleConstructorReturn from\"@babel/runtime/helpers/possibleConstructorReturn\";import _getPrototypeOf from\"@babel/runtime/helpers/getPrototypeOf\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}function _createSuper(Derived){var hasNativeReflectConstruct=_isNativeReflectConstruct();return function _createSuperInternal(){var Super=_getPrototypeOf(Derived),result;if(hasNativeReflectConstruct){var NewTarget=_getPrototypeOf(this).constructor;result=Reflect.construct(Super,arguments,NewTarget);}else{result=Super.apply(this,arguments);}return _possibleConstructorReturn(this,result);};}function _isNativeReflectConstruct(){if(typeof Reflect===\"undefined\"||!Reflect.construct)return false;if(Reflect.construct.sham)return false;if(typeof Proxy===\"function\")return true;try{Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}));return true;}catch(e){return false;}}import memoize from'memoize-one';import PropTypes from'prop-types';import XDate from'xdate';import{Map}from'immutable';import React,{Component}from'react';import FlatList from\"react-native-web/dist/exports/FlatList\";import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import{extractComponentProps}from\"../../component-updater\";import{weekDayNames}from\"../../dateutils\";import{toMarkingFormat}from\"../../interface\";import styleConstructor from\"../style\";import asCalendarConsumer from\"../asCalendarConsumer\";import CalendarList from\"../../calendar-list\";import Week from\"../week\";import Presenter from\"./presenter\";var commons=require(\"../commons\");var NUMBER_OF_PAGES=2;var applyAndroidRtlFix=commons.isAndroid&&commons.isRTL;var WeekCalendar=function(_Component){_inherits(WeekCalendar,_Component);var _super=_createSuper(WeekCalendar);function WeekCalendar(){var _this;_classCallCheck(this,WeekCalendar);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.style=styleConstructor(_this.props.theme);_this.presenter=new Presenter();_this.page=NUMBER_OF_PAGES;_this.firstAndroidRTLScrollIgnored=!applyAndroidRtlFix;_this.state={items:_this.presenter.getDatesArray(_this.props)};_this.getWeekStyle=memoize(function(width,style){return[{width:width},style];});_this.onDayPress=function(value){_this.presenter.onDayPress(_this.props.context,value);};_this.onScroll=function(event){var x=event.nativeEvent.contentOffset.x;var onScroll=_this.presenter.onScroll;var context=_this.props.context;var items=_this.state.items;var _assertThisInitialize=_assertThisInitialized(_this),containerWidth=_assertThisInitialize.containerWidth,page=_assertThisInitialize.page;var updateState=function updateState(newData,newPage){_this.page=newPage;_this.setState({items:_toConsumableArray(newData)});};onScroll({context:context,updateState:updateState,x:x,page:page,items:items,width:containerWidth});};_this.onMomentumScrollEnd=function(){var items=_this.state.items;var onMomentumScrollEnd=_this.presenter.onMomentumScrollEnd;var updateItems=function updateItems(items){setTimeout(function(){_this.setState({items:_toConsumableArray(items)});},100);};onMomentumScrollEnd({items:items,props:_this.props,page:_this.page,updateItems:updateItems});};_this.renderItem=function(_ref){var item=_ref.item;var _extractComponentProp=extractComponentProps(Week,_this.props),style=_extractComponentProp.style,onDayPress=_extractComponentProp.onDayPress,markedDates=_extractComponentProp.markedDates,firstDay=_extractComponentProp.firstDay,others=_objectWithoutProperties(_extractComponentProp,[\"style\",\"onDayPress\",\"markedDates\",\"firstDay\"]);var context=_this.props.context;var isSameWeek=_this.presenter.isSameWeek(item,context.date,firstDay);var currentContext=isSameWeek?context:undefined;return React.createElement(Week,_extends({},others,{key:item,current:item,firstDay:firstDay,style:_this.getWeekStyle(_this.containerWidth,style),markedDates:markedDates,onDayPress:onDayPress||_this.onDayPress,context:currentContext}));};_this.getItemLayout=function(_,index){return{length:_this.containerWidth,offset:_this.containerWidth*index,index:index};};_this.keyExtractor=function(_,index){return index.toString();};_this.renderWeekDaysNames=memoize(function(weekDaysNames){return weekDaysNames.map(function(day,index){return React.createElement(Text,{allowFontScaling:false,key:index,style:_this.style.dayHeader,numberOfLines:1,accessibilityLabel:''},day);});});return _this;}_createClass(WeekCalendar,[{key:\"componentDidUpdate\",value:function componentDidUpdate(prevProps){var context=this.props.context;var _this$presenter=this.presenter,shouldComponentUpdate=_this$presenter.shouldComponentUpdate,getDatesArray=_this$presenter.getDatesArray,scrollToIndex=_this$presenter.scrollToIndex;if(shouldComponentUpdate(context,prevProps.context)){this.setState({items:getDatesArray(this.props)});scrollToIndex(false);}}},{key:\"getDatesArray\",value:function getDatesArray(){var array=[];for(var index=-NUMBER_OF_PAGES;index<=NUMBER_OF_PAGES;index++){var d=this.getDate(index);array.push(d);}return array;}},{key:\"getDate\",value:function getDate(weekIndex){var _this$props=this.props,current=_this$props.current,context=_this$props.context,_this$props$firstDay=_this$props.firstDay,firstDay=_this$props$firstDay===void 0?0:_this$props$firstDay;var d=new XDate(current||context.date);var dayOfTheWeek=d.getDay();if(dayOfTheWeek<firstDay&&firstDay>0){dayOfTheWeek=7+dayOfTheWeek;}var dd=weekIndex===0?d:d.addDays(firstDay-dayOfTheWeek);var newDate=dd.addWeeks(weekIndex);return toMarkingFormat(newDate);}},{key:\"render\",value:function render(){var _this$props2=this.props,allowShadow=_this$props2.allowShadow,firstDay=_this$props2.firstDay,hideDayNames=_this$props2.hideDayNames,current=_this$props2.current,context=_this$props2.context;var items=this.state.items;var weekDaysNames=weekDayNames(firstDay);var extraData=Map({current:current,date:context.date,firstDay:firstDay});return React.createElement(View,{testID:this.props.testID,style:[allowShadow&&this.style.containerShadow,!hideDayNames&&this.style.containerWrapper]},!hideDayNames&&React.createElement(View,{style:[this.style.week,this.style.weekCalendar]},this.renderWeekDaysNames(weekDaysNames)),React.createElement(FlatList,{ref:this.presenter.list,data:items,extraData:extraData,style:this.style.container,horizontal:true,showsHorizontalScrollIndicator:false,pagingEnabled:true,scrollEnabled:true,renderItem:this.renderItem,keyExtractor:this.keyExtractor,initialScrollIndex:NUMBER_OF_PAGES,getItemLayout:this.getItemLayout,onScroll:this.onScroll,onMomentumScrollEnd:this.onMomentumScrollEnd}));}},{key:\"containerWidth\",get:function get(){return this.props.calendarWidth||commons.screenWidth;}}]);return WeekCalendar;}(Component);WeekCalendar.displayName='WeekCalendar';WeekCalendar.propTypes=_objectSpread(_objectSpread({},CalendarList.propTypes),{},{current:PropTypes.any,allowShadow:PropTypes.bool,hideDayNames:PropTypes.bool});WeekCalendar.defaultProps={firstDay:0,allowShadow:true};export default asCalendarConsumer(WeekCalendar);","map":{"version":3,"sources":["/app/node_modules/react-native-calendars/src/expandableCalendar/WeekCalendar/index.js"],"names":["memoize","PropTypes","XDate","Map","React","Component","extractComponentProps","weekDayNames","toMarkingFormat","styleConstructor","asCalendarConsumer","CalendarList","Week","Presenter","commons","require","NUMBER_OF_PAGES","applyAndroidRtlFix","isAndroid","isRTL","WeekCalendar","style","props","theme","presenter","page","firstAndroidRTLScrollIgnored","state","items","getDatesArray","getWeekStyle","width","onDayPress","value","context","onScroll","event","x","nativeEvent","contentOffset","containerWidth","updateState","newData","newPage","setState","onMomentumScrollEnd","updateItems","setTimeout","renderItem","item","markedDates","firstDay","others","isSameWeek","date","currentContext","undefined","getItemLayout","_","index","length","offset","keyExtractor","toString","renderWeekDaysNames","weekDaysNames","map","day","dayHeader","prevProps","shouldComponentUpdate","scrollToIndex","array","d","getDate","push","weekIndex","current","dayOfTheWeek","getDay","dd","addDays","newDate","addWeeks","allowShadow","hideDayNames","extraData","testID","containerShadow","containerWrapper","week","weekCalendar","list","container","calendarWidth","screenWidth","displayName","propTypes","any","bool","defaultProps"],"mappings":"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","sourcesContent":["import memoize from 'memoize-one';\nimport PropTypes from 'prop-types';\nimport XDate from 'xdate';\nimport { Map } from 'immutable';\nimport React, { Component } from 'react';\nimport { FlatList, View, Text } from 'react-native';\n// @ts-expect-error\nimport { extractComponentProps } from '../../component-updater';\n// @ts-expect-error\nimport { weekDayNames } from '../../dateutils';\n// @ts-expect-error\nimport { toMarkingFormat } from '../../interface';\nimport styleConstructor from '../style';\nimport asCalendarConsumer from '../asCalendarConsumer';\nimport CalendarList from '../../calendar-list';\nimport Week from '../week';\nimport Presenter from './presenter';\nconst commons = require('../commons');\nconst NUMBER_OF_PAGES = 2; // must be a positive number\nconst applyAndroidRtlFix = commons.isAndroid && commons.isRTL;\n/**\n * @description: Week calendar component\n * @note: Should be wrapped with 'CalendarProvider'\n * @example: https://github.com/wix/react-native-calendars/blob/master/example/src/screens/expandableCalendar.js\n */\nclass WeekCalendar extends Component {\n    static displayName = 'WeekCalendar';\n    static propTypes = {\n        ...CalendarList.propTypes,\n        /** the current date */\n        current: PropTypes.any,\n        /** whether to have shadow/elevation for the calendar */\n        allowShadow: PropTypes.bool,\n        /** whether to hide the names of the week days */\n        hideDayNames: PropTypes.bool\n    };\n    static defaultProps = {\n        firstDay: 0,\n        allowShadow: true\n    };\n    style = styleConstructor(this.props.theme);\n    presenter = new Presenter();\n    page = NUMBER_OF_PAGES;\n    // On Android+RTL there's an initial scroll that cause issues\n    firstAndroidRTLScrollIgnored = !applyAndroidRtlFix;\n    state = {\n        items: this.presenter.getDatesArray(this.props)\n    };\n    componentDidUpdate(prevProps) {\n        const { context } = this.props;\n        const { shouldComponentUpdate, getDatesArray, scrollToIndex } = this.presenter;\n        if (shouldComponentUpdate(context, prevProps.context)) {\n            this.setState({ items: getDatesArray(this.props) });\n            scrollToIndex(false);\n        }\n    }\n    get containerWidth() {\n        return this.props.calendarWidth || commons.screenWidth;\n    }\n    getDatesArray() {\n        const array = [];\n        for (let index = -NUMBER_OF_PAGES; index <= NUMBER_OF_PAGES; index++) {\n            const d = this.getDate(index);\n            array.push(d);\n        }\n        return array;\n    }\n    getDate(weekIndex) {\n        const { current, context, firstDay = 0 } = this.props;\n        const d = new XDate(current || context.date);\n        // get the first day of the week as date (for the on scroll mark)\n        let dayOfTheWeek = d.getDay();\n        if (dayOfTheWeek < firstDay && firstDay > 0) {\n            dayOfTheWeek = 7 + dayOfTheWeek;\n        }\n        // leave the current date in the visible week as is\n        const dd = weekIndex === 0 ? d : d.addDays(firstDay - dayOfTheWeek);\n        const newDate = dd.addWeeks(weekIndex);\n        return toMarkingFormat(newDate);\n    }\n    getWeekStyle = memoize((width, style) => {\n        return [{ width }, style];\n    });\n    onDayPress = (value) => {\n        this.presenter.onDayPress(this.props.context, value);\n    };\n    onScroll = (event) => {\n        const x = event.nativeEvent.contentOffset.x;\n        const { onScroll } = this.presenter;\n        const { context } = this.props;\n        const { items } = this.state;\n        const { containerWidth, page } = this;\n        const updateState = (newData, newPage) => {\n            this.page = newPage;\n            this.setState({ items: [...newData] });\n        };\n        onScroll({ context, updateState, x, page, items, width: containerWidth });\n    };\n    onMomentumScrollEnd = () => {\n        const { items } = this.state;\n        const { onMomentumScrollEnd } = this.presenter;\n        const updateItems = (items) => {\n            setTimeout(() => {\n                this.setState({ items: [...items] });\n            }, 100);\n        };\n        onMomentumScrollEnd({ items, props: this.props, page: this.page, updateItems });\n    };\n    renderItem = ({ item }) => {\n        const { style, onDayPress, markedDates, firstDay, ...others } = extractComponentProps(Week, this.props);\n        const { context } = this.props;\n        const isSameWeek = this.presenter.isSameWeek(item, context.date, firstDay);\n        const currentContext = isSameWeek ? context : undefined;\n        return (<Week {...others} key={item} current={item} firstDay={firstDay} style={this.getWeekStyle(this.containerWidth, style)} markedDates={markedDates} onDayPress={onDayPress || this.onDayPress} context={currentContext}/>);\n    };\n    getItemLayout = (_, index) => {\n        return {\n            length: this.containerWidth,\n            offset: this.containerWidth * index,\n            index\n        };\n    };\n    keyExtractor = (_, index) => index.toString();\n    renderWeekDaysNames = memoize(weekDaysNames => {\n        return weekDaysNames.map((day, index) => (<Text allowFontScaling={false} key={index} style={this.style.dayHeader} numberOfLines={1} accessibilityLabel={''}>\n        {day}\n      </Text>));\n    });\n    render() {\n        const { allowShadow, firstDay, hideDayNames, current, context } = this.props;\n        const { items } = this.state;\n        const weekDaysNames = weekDayNames(firstDay);\n        const extraData = Map({\n            current,\n            date: context.date,\n            firstDay\n        });\n        return (<View testID={this.props.testID} style={[allowShadow && this.style.containerShadow, !hideDayNames && this.style.containerWrapper]}>\n        {!hideDayNames && (<View style={[this.style.week, this.style.weekCalendar]}>\n            {/* {this.props.weekNumbers && <Text allowFontScaling={false} style={this.style.dayHeader}></Text>} */}\n            {this.renderWeekDaysNames(weekDaysNames)}\n          </View>)}\n        <FlatList ref={this.presenter.list} data={items} extraData={extraData} style={this.style.container} horizontal showsHorizontalScrollIndicator={false} pagingEnabled scrollEnabled renderItem={this.renderItem} keyExtractor={this.keyExtractor} initialScrollIndex={NUMBER_OF_PAGES} getItemLayout={this.getItemLayout} onScroll={this.onScroll} onMomentumScrollEnd={this.onMomentumScrollEnd}/>\n      </View>);\n    }\n}\nexport default asCalendarConsumer(WeekCalendar);\n"]},"metadata":{},"sourceType":"module"}