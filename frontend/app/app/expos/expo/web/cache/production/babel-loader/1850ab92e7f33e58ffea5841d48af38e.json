{"ast":null,"code":"import _regeneratorRuntime from\"@babel/runtime/regenerator\";import _defineProperty from\"@babel/runtime/helpers/defineProperty\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);if(enumerableOnly){symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;});}keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=arguments[i]!=null?arguments[i]:{};if(i%2){ownKeys(Object(source),true).forEach(function(key){_defineProperty(target,key,source[key]);});}else if(Object.getOwnPropertyDescriptors){Object.defineProperties(target,Object.getOwnPropertyDescriptors(source));}else{ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}}return target;}import{Platform}from'@unimodules/core';import{Asset}from'expo-asset';import ExponentAV from\"./ExponentAV\";export var PitchCorrectionQuality;(function(PitchCorrectionQuality){PitchCorrectionQuality[PitchCorrectionQuality[\"Low\"]=ExponentAV&&ExponentAV.Qualities&&ExponentAV.Qualities.Low]=\"Low\";PitchCorrectionQuality[PitchCorrectionQuality[\"Medium\"]=ExponentAV&&ExponentAV.Qualities&&ExponentAV.Qualities.Medium]=\"Medium\";PitchCorrectionQuality[PitchCorrectionQuality[\"High\"]=ExponentAV&&ExponentAV.Qualities&&ExponentAV.Qualities.High]=\"High\";})(PitchCorrectionQuality||(PitchCorrectionQuality={}));export var _DEFAULT_PROGRESS_UPDATE_INTERVAL_MILLIS=500;export var _DEFAULT_INITIAL_PLAYBACK_STATUS={positionMillis:0,progressUpdateIntervalMillis:_DEFAULT_PROGRESS_UPDATE_INTERVAL_MILLIS,shouldPlay:false,rate:1.0,shouldCorrectPitch:false,volume:1.0,isMuted:false,isLooping:false};export function getNativeSourceFromSource(source){var uri=null;var overridingExtension=null;var headers;if(typeof source==='string'&&Platform.OS==='web'){return{uri:source,overridingExtension:overridingExtension,headers:headers};}var asset=_getAssetFromPlaybackSource(source);if(asset!=null){uri=asset.localUri||asset.uri;}else if(source!=null&&typeof source!=='number'&&'uri'in source&&typeof source.uri==='string'){uri=source.uri;}if(uri==null){return null;}if(source!=null&&typeof source!=='number'&&'overrideFileExtensionAndroid'in source&&typeof source.overrideFileExtensionAndroid==='string'){overridingExtension=source.overrideFileExtensionAndroid;}if(source!=null&&typeof source!=='number'&&'headers'in source&&typeof source.headers==='object'){headers=source.headers;}return{uri:uri,overridingExtension:overridingExtension,headers:headers};}function _getAssetFromPlaybackSource(source){if(source==null){return null;}var asset=null;if(typeof source==='number'){asset=Asset.fromModule(source);}else if(source instanceof Asset){asset=source;}return asset;}export function assertStatusValuesInBounds(status){if(typeof status.rate==='number'&&(status.rate<0||status.rate>32)){throw new RangeError('Rate value must be between 0.0 and 32.0');}if(typeof status.volume==='number'&&(status.volume<0||status.volume>1)){throw new RangeError('Volume value must be between 0.0 and 1.0');}}export function getNativeSourceAndFullInitialStatusForLoadAsync(source,initialStatus,downloadFirst){var fullInitialStatus,asset,nativeSource;return _regeneratorRuntime.async(function getNativeSourceAndFullInitialStatusForLoadAsync$(_context){while(1){switch(_context.prev=_context.next){case 0:fullInitialStatus=initialStatus==null?_DEFAULT_INITIAL_PLAYBACK_STATUS:_objectSpread(_objectSpread({},_DEFAULT_INITIAL_PLAYBACK_STATUS),initialStatus);assertStatusValuesInBounds(fullInitialStatus);if(!(typeof source==='string'&&Platform.OS==='web')){_context.next=4;break;}return _context.abrupt(\"return\",{nativeSource:{uri:source,overridingExtension:null},fullInitialStatus:fullInitialStatus});case 4:asset=_getAssetFromPlaybackSource(source);if(!(downloadFirst&&asset)){_context.next=8;break;}_context.next=8;return _regeneratorRuntime.awrap(asset.downloadAsync());case 8:nativeSource=getNativeSourceFromSource(source);if(!(nativeSource===null)){_context.next=11;break;}throw new Error(\"Cannot load an AV asset from a null playback source\");case 11:return _context.abrupt(\"return\",{nativeSource:nativeSource,fullInitialStatus:fullInitialStatus});case 12:case\"end\":return _context.stop();}}},null,null,null,Promise);}export function getUnloadedStatus(){var error=arguments.length>0&&arguments[0]!==undefined?arguments[0]:null;return _objectSpread({isLoaded:false},error?{error:error}:null);}export var PlaybackMixin={playAsync:function playAsync(){return _regeneratorRuntime.async(function playAsync$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:return _context2.abrupt(\"return\",this.setStatusAsync({shouldPlay:true}));case 1:case\"end\":return _context2.stop();}}},null,this,null,Promise);},playFromPositionAsync:function playFromPositionAsync(positionMillis){var tolerances,_args3=arguments;return _regeneratorRuntime.async(function playFromPositionAsync$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:tolerances=_args3.length>1&&_args3[1]!==undefined?_args3[1]:{};return _context3.abrupt(\"return\",this.setStatusAsync({positionMillis:positionMillis,shouldPlay:true,seekMillisToleranceAfter:tolerances.toleranceMillisAfter,seekMillisToleranceBefore:tolerances.toleranceMillisBefore}));case 2:case\"end\":return _context3.stop();}}},null,this,null,Promise);},pauseAsync:function pauseAsync(){return _regeneratorRuntime.async(function pauseAsync$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:return _context4.abrupt(\"return\",this.setStatusAsync({shouldPlay:false}));case 1:case\"end\":return _context4.stop();}}},null,this,null,Promise);},stopAsync:function stopAsync(){return _regeneratorRuntime.async(function stopAsync$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:return _context5.abrupt(\"return\",this.setStatusAsync({positionMillis:0,shouldPlay:false}));case 1:case\"end\":return _context5.stop();}}},null,this,null,Promise);},setPositionAsync:function setPositionAsync(positionMillis){var tolerances,_args6=arguments;return _regeneratorRuntime.async(function setPositionAsync$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:tolerances=_args6.length>1&&_args6[1]!==undefined?_args6[1]:{};return _context6.abrupt(\"return\",this.setStatusAsync({positionMillis:positionMillis,seekMillisToleranceAfter:tolerances.toleranceMillisAfter,seekMillisToleranceBefore:tolerances.toleranceMillisBefore}));case 2:case\"end\":return _context6.stop();}}},null,this,null,Promise);},setRateAsync:function setRateAsync(rate){var shouldCorrectPitch,pitchCorrectionQuality,_args7=arguments;return _regeneratorRuntime.async(function setRateAsync$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:shouldCorrectPitch=_args7.length>1&&_args7[1]!==undefined?_args7[1]:false;pitchCorrectionQuality=_args7.length>2&&_args7[2]!==undefined?_args7[2]:PitchCorrectionQuality.Low;return _context7.abrupt(\"return\",this.setStatusAsync({rate:rate,shouldCorrectPitch:shouldCorrectPitch,pitchCorrectionQuality:pitchCorrectionQuality}));case 3:case\"end\":return _context7.stop();}}},null,this,null,Promise);},setVolumeAsync:function setVolumeAsync(volume){return _regeneratorRuntime.async(function setVolumeAsync$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:return _context8.abrupt(\"return\",this.setStatusAsync({volume:volume}));case 1:case\"end\":return _context8.stop();}}},null,this,null,Promise);},setIsMutedAsync:function setIsMutedAsync(isMuted){return _regeneratorRuntime.async(function setIsMutedAsync$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:return _context9.abrupt(\"return\",this.setStatusAsync({isMuted:isMuted}));case 1:case\"end\":return _context9.stop();}}},null,this,null,Promise);},setIsLoopingAsync:function setIsLoopingAsync(isLooping){return _regeneratorRuntime.async(function setIsLoopingAsync$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:return _context10.abrupt(\"return\",this.setStatusAsync({isLooping:isLooping}));case 1:case\"end\":return _context10.stop();}}},null,this,null,Promise);},setProgressUpdateIntervalAsync:function setProgressUpdateIntervalAsync(progressUpdateIntervalMillis){return _regeneratorRuntime.async(function setProgressUpdateIntervalAsync$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:return _context11.abrupt(\"return\",this.setStatusAsync({progressUpdateIntervalMillis:progressUpdateIntervalMillis}));case 1:case\"end\":return _context11.stop();}}},null,this,null,Promise);}};","map":{"version":3,"sources":["../src/AV.ts"],"names":[],"mappings":"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","sourcesContent":["import { Platform } from '@unimodules/core';\nimport { Asset } from 'expo-asset';\n\nimport ExponentAV from './ExponentAV';\n// TODO add:\n//  disableFocusOnAndroid\n//  audio routes (at least did become noisy on android)\n//  pan\n//  pitch\n//  API to explicitly request audio focus / session\n//  API to select stream type on Android\n//  subtitles API\n\nexport enum PitchCorrectionQuality {\n  Low = ExponentAV && ExponentAV.Qualities && ExponentAV.Qualities.Low,\n  Medium = ExponentAV && ExponentAV.Qualities && ExponentAV.Qualities.Medium,\n  High = ExponentAV && ExponentAV.Qualities && ExponentAV.Qualities.High,\n}\n\nexport type AVPlaybackSource =\n  | number\n  | {\n      uri: string;\n      overrideFileExtensionAndroid?: string;\n      headers?: { [fieldName: string]: string };\n    }\n  | Asset;\n\nexport type AVPlaybackNativeSource = {\n  uri: string;\n  overridingExtension?: string | null;\n  headers?: { [fieldName: string]: string };\n};\n\nexport type AVPlaybackStatus =\n  | {\n      isLoaded: false;\n      androidImplementation?: string;\n      error?: string; // populated exactly once when an error forces the object to unload\n    }\n  | {\n      isLoaded: true;\n      androidImplementation?: string;\n\n      uri: string;\n\n      progressUpdateIntervalMillis: number;\n      durationMillis?: number;\n      positionMillis: number;\n      playableDurationMillis?: number;\n      seekMillisToleranceBefore?: number;\n      seekMillisToleranceAfter?: number;\n\n      shouldPlay: boolean;\n      isPlaying: boolean;\n      isBuffering: boolean;\n\n      rate: number;\n      shouldCorrectPitch: boolean;\n      volume: number;\n      isMuted: boolean;\n      isLooping: boolean;\n\n      didJustFinish: boolean; // true exactly once when the track plays to finish\n    };\n\nexport type AVPlaybackStatusToSet = {\n  androidImplementation?: string;\n  progressUpdateIntervalMillis?: number;\n  positionMillis?: number;\n  seekMillisToleranceBefore?: number;\n  seekMillisToleranceAfter?: number;\n  shouldPlay?: boolean;\n  rate?: number;\n  shouldCorrectPitch?: boolean;\n  volume?: number;\n  isMuted?: boolean;\n  isLooping?: boolean;\n  pitchCorrectionQuality?: PitchCorrectionQuality;\n};\n\nexport const _DEFAULT_PROGRESS_UPDATE_INTERVAL_MILLIS: number = 500;\nexport const _DEFAULT_INITIAL_PLAYBACK_STATUS: AVPlaybackStatusToSet = {\n  positionMillis: 0,\n  progressUpdateIntervalMillis: _DEFAULT_PROGRESS_UPDATE_INTERVAL_MILLIS,\n  shouldPlay: false,\n  rate: 1.0,\n  shouldCorrectPitch: false,\n  volume: 1.0,\n  isMuted: false,\n  isLooping: false,\n};\n\nexport function getNativeSourceFromSource(\n  source?: AVPlaybackSource | null\n): AVPlaybackNativeSource | null {\n  let uri: string | null = null;\n  let overridingExtension: string | null = null;\n  let headers: { [fieldName: string]: string } | undefined;\n\n  if (typeof source === 'string' && Platform.OS === 'web') {\n    return {\n      uri: source,\n      overridingExtension,\n      headers,\n    };\n  }\n\n  const asset: Asset | null = _getAssetFromPlaybackSource(source);\n  if (asset != null) {\n    uri = asset.localUri || asset.uri;\n  } else if (\n    source != null &&\n    typeof source !== 'number' &&\n    'uri' in source &&\n    typeof source.uri === 'string'\n  ) {\n    uri = source.uri;\n  }\n\n  if (uri == null) {\n    return null;\n  }\n\n  if (\n    source != null &&\n    typeof source !== 'number' &&\n    'overrideFileExtensionAndroid' in source &&\n    typeof source.overrideFileExtensionAndroid === 'string'\n  ) {\n    overridingExtension = source.overrideFileExtensionAndroid;\n  }\n\n  if (\n    source != null &&\n    typeof source !== 'number' &&\n    'headers' in source &&\n    typeof source.headers === 'object'\n  ) {\n    headers = source.headers;\n  }\n  return { uri, overridingExtension, headers };\n}\n\nfunction _getAssetFromPlaybackSource(source?: AVPlaybackSource | null): Asset | null {\n  if (source == null) {\n    return null;\n  }\n\n  let asset: Asset | null = null;\n  if (typeof source === 'number') {\n    asset = Asset.fromModule(source);\n  } else if (source instanceof Asset) {\n    asset = source;\n  }\n  return asset;\n}\n\nexport function assertStatusValuesInBounds(status: AVPlaybackStatusToSet): void {\n  if (typeof status.rate === 'number' && (status.rate < 0 || status.rate > 32)) {\n    throw new RangeError('Rate value must be between 0.0 and 32.0');\n  }\n  if (typeof status.volume === 'number' && (status.volume < 0 || status.volume > 1)) {\n    throw new RangeError('Volume value must be between 0.0 and 1.0');\n  }\n}\n\nexport async function getNativeSourceAndFullInitialStatusForLoadAsync(\n  source: AVPlaybackSource | null,\n  initialStatus: AVPlaybackStatusToSet | null,\n  downloadFirst: boolean\n): Promise<{\n  nativeSource: AVPlaybackNativeSource;\n  fullInitialStatus: AVPlaybackStatusToSet;\n}> {\n  // Get the full initial status\n  const fullInitialStatus: AVPlaybackStatusToSet =\n    initialStatus == null\n      ? _DEFAULT_INITIAL_PLAYBACK_STATUS\n      : {\n          ..._DEFAULT_INITIAL_PLAYBACK_STATUS,\n          ...initialStatus,\n        };\n  assertStatusValuesInBounds(fullInitialStatus);\n\n  if (typeof source === 'string' && Platform.OS === 'web') {\n    return {\n      nativeSource: {\n        uri: source,\n        overridingExtension: null,\n      },\n      fullInitialStatus,\n    };\n  }\n\n  // Download first if necessary.\n  const asset = _getAssetFromPlaybackSource(source);\n  if (downloadFirst && asset) {\n    // TODO we can download remote uri too once @nikki93 has integrated this into Asset\n    await asset.downloadAsync();\n  }\n\n  // Get the native source\n  const nativeSource: AVPlaybackNativeSource | null = getNativeSourceFromSource(source);\n\n  if (nativeSource === null) {\n    throw new Error(`Cannot load an AV asset from a null playback source`);\n  }\n\n  return { nativeSource, fullInitialStatus };\n}\n\nexport function getUnloadedStatus(error: string | null = null): AVPlaybackStatus {\n  return {\n    isLoaded: false,\n    ...(error ? { error } : null),\n  };\n}\n\nexport interface AV {\n  setStatusAsync(status: AVPlaybackStatusToSet): Promise<AVPlaybackStatus>;\n  getStatusAsync(): Promise<AVPlaybackStatus>;\n}\n\nexport interface Playback extends AV {\n  playAsync(): Promise<AVPlaybackStatus>;\n  loadAsync(\n    source: AVPlaybackSource,\n    initialStatus: AVPlaybackStatusToSet,\n    downloadAsync: boolean\n  ): Promise<AVPlaybackStatus>;\n  unloadAsync(): Promise<AVPlaybackStatus>;\n  playFromPositionAsync(\n    positionMillis: number,\n    tolerances?: { toleranceMillisBefore?: number; toleranceMillisAfter?: number }\n  ): Promise<AVPlaybackStatus>;\n  pauseAsync(): Promise<AVPlaybackStatus>;\n  stopAsync(): Promise<AVPlaybackStatus>;\n  replayAsync(status: AVPlaybackStatusToSet): Promise<AVPlaybackStatus>;\n  setPositionAsync(\n    positionMillis: number,\n    tolerances?: { toleranceMillisBefore?: number; toleranceMillisAfter?: number }\n  ): Promise<AVPlaybackStatus>;\n  setRateAsync(\n    rate: number,\n    shouldCorrectPitch: boolean,\n    pitchCorrectionQuality?: PitchCorrectionQuality\n  ): Promise<AVPlaybackStatus>;\n  setVolumeAsync(volume: number): Promise<AVPlaybackStatus>;\n  setIsMutedAsync(isMuted: boolean): Promise<AVPlaybackStatus>;\n  setIsLoopingAsync(isLooping: boolean): Promise<AVPlaybackStatus>;\n  setProgressUpdateIntervalAsync(progressUpdateIntervalMillis: number): Promise<AVPlaybackStatus>;\n}\n\n/**\n * A mixin that defines common playback methods for A/V classes so they implement the `Playback`\n * interface\n */\nexport const PlaybackMixin = {\n  async playAsync(): Promise<AVPlaybackStatus> {\n    return ((this as any) as Playback).setStatusAsync({ shouldPlay: true });\n  },\n\n  async playFromPositionAsync(\n    positionMillis: number,\n    tolerances: { toleranceMillisBefore?: number; toleranceMillisAfter?: number } = {}\n  ): Promise<AVPlaybackStatus> {\n    return ((this as any) as Playback).setStatusAsync({\n      positionMillis,\n      shouldPlay: true,\n      seekMillisToleranceAfter: tolerances.toleranceMillisAfter,\n      seekMillisToleranceBefore: tolerances.toleranceMillisBefore,\n    });\n  },\n\n  async pauseAsync(): Promise<AVPlaybackStatus> {\n    return ((this as any) as Playback).setStatusAsync({ shouldPlay: false });\n  },\n\n  async stopAsync(): Promise<AVPlaybackStatus> {\n    return ((this as any) as Playback).setStatusAsync({ positionMillis: 0, shouldPlay: false });\n  },\n\n  async setPositionAsync(\n    positionMillis: number,\n    tolerances: { toleranceMillisBefore?: number; toleranceMillisAfter?: number } = {}\n  ): Promise<AVPlaybackStatus> {\n    return ((this as any) as Playback).setStatusAsync({\n      positionMillis,\n      seekMillisToleranceAfter: tolerances.toleranceMillisAfter,\n      seekMillisToleranceBefore: tolerances.toleranceMillisBefore,\n    });\n  },\n\n  async setRateAsync(\n    rate: number,\n    shouldCorrectPitch: boolean = false,\n    pitchCorrectionQuality: PitchCorrectionQuality = PitchCorrectionQuality.Low\n  ): Promise<AVPlaybackStatus> {\n    return ((this as any) as Playback).setStatusAsync({\n      rate,\n      shouldCorrectPitch,\n      pitchCorrectionQuality,\n    });\n  },\n\n  async setVolumeAsync(volume: number): Promise<AVPlaybackStatus> {\n    return ((this as any) as Playback).setStatusAsync({ volume });\n  },\n\n  async setIsMutedAsync(isMuted: boolean): Promise<AVPlaybackStatus> {\n    return ((this as any) as Playback).setStatusAsync({ isMuted });\n  },\n\n  async setIsLoopingAsync(isLooping: boolean): Promise<AVPlaybackStatus> {\n    return ((this as any) as Playback).setStatusAsync({ isLooping });\n  },\n\n  async setProgressUpdateIntervalAsync(\n    progressUpdateIntervalMillis: number\n  ): Promise<AVPlaybackStatus> {\n    return ((this as any) as Playback).setStatusAsync({ progressUpdateIntervalMillis });\n  },\n};\n"],"sourceRoot":""},"metadata":{},"sourceType":"module"}