{"ast":null,"code":"\"use strict\";Object.defineProperty(exports,\"__esModule\",{value:true});exports.useTNodeChildrenProps=useTNodeChildrenProps;exports.default=void 0;var _react=_interopRequireDefault(require(\"react\"));var _SharedPropsProvider=require(\"./context/SharedPropsProvider\");var _TChildrenRenderer=_interopRequireWildcard(require(\"./TChildrenRenderer\"));function _getRequireWildcardCache(nodeInterop){if(typeof WeakMap!==\"function\")return null;var cacheBabelInterop=new WeakMap();var cacheNodeInterop=new WeakMap();return(_getRequireWildcardCache=function _getRequireWildcardCache(nodeInterop){return nodeInterop?cacheNodeInterop:cacheBabelInterop;})(nodeInterop);}function _interopRequireWildcard(obj,nodeInterop){if(!nodeInterop&&obj&&obj.__esModule){return obj;}if(obj===null||typeof obj!==\"object\"&&typeof obj!==\"function\"){return{default:obj};}var cache=_getRequireWildcardCache(nodeInterop);if(cache&&cache.has(obj)){return cache.get(obj);}var newObj={};var hasPropertyDescriptor=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var key in obj){if(key!==\"default\"&&Object.prototype.hasOwnProperty.call(obj,key)){var desc=hasPropertyDescriptor?Object.getOwnPropertyDescriptor(obj,key):null;if(desc&&(desc.get||desc.set)){Object.defineProperty(newObj,key,desc);}else{newObj[key]=obj[key];}}}newObj.default=obj;if(cache){cache.set(obj,newObj);}return newObj;}function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj};}function isCollapsible(tnode){return tnode.type==='block'||tnode.type==='phrasing';}function useTNodeChildrenProps(_ref){var tnode=_ref.tnode,propsForChildren=_ref.propsForChildren,_ref$disableMarginCol=_ref.disableMarginCollapsing,disableMarginCollapsing=_ref$disableMarginCol===void 0?false:_ref$disableMarginCol,renderChild=_ref.renderChild;var _ref2=(0,_SharedPropsProvider.useSharedProps)(),enableExperimentalMarginCollapsing=_ref2.enableExperimentalMarginCollapsing;var shouldCollapseChildren=enableExperimentalMarginCollapsing&&!disableMarginCollapsing&&isCollapsible(tnode);return{propsForChildren:propsForChildren,disableMarginCollapsing:!shouldCollapseChildren,tchildren:tnode.children,renderChild:renderChild};}var TNodeWithChildrenRenderer=function TNodeWithChildrenRenderer(props){return _react.default.createElement(_TChildrenRenderer.default,useTNodeChildrenProps(props));};function TNodeChildrenRenderer(props){if(props.tnode.type==='text'){return props.tnode.data;}return _react.default.createElement(TNodeWithChildrenRenderer,props);}TNodeChildrenRenderer.defaultProps=_TChildrenRenderer.tchildrenRendererDefaultProps;var _default=TNodeChildrenRenderer;exports.default=_default;","map":{"version":3,"sources":["TNodeChildrenRenderer.tsx"],"names":["tnode","disableMarginCollapsing","renderChild","enableExperimentalMarginCollapsing","shouldCollapseChildren","isCollapsible","propsForChildren","tchildren","TNodeWithChildrenRenderer","React","TChildrenRenderer","useTNodeChildrenProps","props","TNodeChildrenRenderer","tchildrenRendererDefaultProps"],"mappings":"iJAAA,GAAA,CAAA,MAAA,CAAA,sBAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA,CAEA,GAAA,CAAA,oBAAA,CAAA,OAAA,iCAAA,CACA,GAAA,CAAA,kBAAA,CAAA,uBAAA,CAAA,OAAA,uBAAA,CAAA,C,6kCAQA,QAAA,CAAA,aAAA,CAAA,KAAA,CAAqC,CACnC,MAAOA,CAAAA,KAAK,CAALA,IAAAA,GAAAA,OAAAA,EAA0BA,KAAK,CAALA,IAAAA,GAAjC,UAAA,CACD,CA4BM,QAAA,CAAA,qBAAA,MAKgD,IALjB,CAAA,KAKiB,MALjB,KAKiB,CALjB,gBAKiB,MALjB,gBAKiB,4BAFrDC,uBAEqD,CAFrDA,uBAEqD,gCALjB,KAKiB,uBADrDC,WACqD,MADrDA,WACqD,WACN,CAAA,EAAA,oBAAA,CAA/C,cAA+C,GADM,CAC7CC,kCAD6C,OAC7CA,kCAD6C,CAErD,GAAMC,CAAAA,sBAAsB,CAC1BD,kCAAkC,EAClC,CADAA,uBAAAA,EAEAE,aAAa,CAHf,KAGe,CAHf,CAIA,MAAO,CACLC,gBADK,CACLA,gBADK,CAELL,uBAAuB,CAAE,CAFpB,sBAAA,CAGLM,SAAS,CAAEP,KAAK,CAHX,QAAA,CAILE,WAAAA,CAAAA,WAJK,CAAP,CAMD,CAED,GAAMM,CAAAA,yBAAyB,CAAG,QAAA,CAAA,yBAAA,CAAA,KAAA,CAEhC,CACA,MAAOC,CAAAA,MAAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAoBC,kBAAAA,CAApBD,OAAAA,CAAuCE,qBAAqB,CAAnE,KAAmE,CAA5DF,CAAP,CAHF,CAAA,CASA,QAAA,CAAA,qBAAA,CAAA,KAAA,CAEgB,CACd,GAAIG,KAAK,CAALA,KAAAA,CAAAA,IAAAA,GAAJ,MAAA,CAAiC,CAE/B,MAAOA,CAAAA,KAAK,CAALA,KAAAA,CAAP,IAAA,CACD,CACD,MAAOH,CAAAA,MAAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAAA,yBAAAA,CAAP,KAAOA,CAAP,CACD,CAKDI,qBAAqB,CAArBA,YAAAA,CAAqCC,kBAAAA,CAArCD,6BAAAA,C,aAEeA,qB","sourcesContent":["import React, { ReactElement } from 'react';\nimport { TNode } from '@native-html/transient-render-engine';\nimport { useSharedProps } from './context/SharedPropsProvider';\nimport TChildrenRenderer, {\n  tchildrenRendererDefaultProps\n} from './TChildrenRenderer';\nimport {\n  TChildrenRendererProps,\n  TNodeChildrenRendererProps\n} from './shared-types';\n\nfunction isCollapsible(tnode: TNode) {\n  return tnode.type === 'block' || tnode.type === 'phrasing';\n}\n\n/**\n * A hook especially useful when one need to tamper with children in a custom\n * renderer. Should be used with {@link TChildrenRenderer}.\n *\n * @example\n * For example, a custom renderer which inserts ads in an article:\n *\n * ```tsx\n * function ArticleRenderer(props) {\n *   const { tnode, TDefaultRenderer, ...defaultRendererProps } = props;\n *   const tchildrenProps = useTNodeChildrenProps(props);\n *   const firstChildrenChunk = tnode.children.slice(0, 2);\n *   const secondChildrenChunk = tnode.children.slice(2, 4);\n *   const thirdChildrenChunk = tnode.children.slice(4, 5);\n *   return (\n *     <TDefaultRenderer tnode={tnode} {...defaultRendererProps}>\n *       <TChildrenRenderer {...tchildrenProps} tchildren={firstChildrenChunk} />\n *       {firstChildrenChunk.length === 2 ? <AdComponent /> : null}\n *       <TChildrenRenderer {...tchildrenProps} tchildren={secondChildrenChunk} />\n *       {secondChildrenChunk.length === 2 ? <AdComponent /> : null}\n *       <TChildrenRenderer {...tchildrenProps} tchildren={thirdChildrenChunk} />\n *     </TDefaultRenderer>\n *   );\n * };\n * ```\n */\nexport function useTNodeChildrenProps({\n  tnode,\n  propsForChildren,\n  disableMarginCollapsing = false,\n  renderChild\n}: TNodeChildrenRendererProps): TChildrenRendererProps {\n  const { enableExperimentalMarginCollapsing } = useSharedProps();\n  const shouldCollapseChildren =\n    enableExperimentalMarginCollapsing &&\n    !disableMarginCollapsing &&\n    isCollapsible(tnode);\n  return {\n    propsForChildren,\n    disableMarginCollapsing: !shouldCollapseChildren,\n    tchildren: tnode.children,\n    renderChild\n  };\n}\n\nconst TNodeWithChildrenRenderer = function TNodeWithChildrenRenderer(\n  props: TNodeChildrenRendererProps\n) {\n  return React.createElement(TChildrenRenderer, useTNodeChildrenProps(props));\n};\n\n/**\n * A component to render all children of a {@link TNode}.\n */\nfunction TNodeChildrenRenderer(\n  props: TNodeChildrenRendererProps\n): ReactElement {\n  if (props.tnode.type === 'text') {\n    // see https://github.com/DefinitelyTyped/DefinitelyTyped/issues/20544\n    return props.tnode.data as unknown as ReactElement;\n  }\n  return React.createElement(TNodeWithChildrenRenderer, props);\n}\n\n/**\n * @ignore\n */\nTNodeChildrenRenderer.defaultProps = tchildrenRendererDefaultProps;\n\nexport default TNodeChildrenRenderer;\n"]},"metadata":{},"sourceType":"script"}