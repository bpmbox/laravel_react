{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport firebase from 'firebase';\n\nvar FirebaseStorage = function () {\n  function FirebaseStorage() {\n    var _this = this;\n\n    _classCallCheck(this, FirebaseStorage);\n\n    this.initd = function () {\n      if (!firebase.apps.length) {\n        firebase.initializeApp({\n          apiKey: \"AIzaSyDZJZm9TgdBItFu1agAWryuKHWXv8og4pE\",\n          authDomain: \"stachka-example.firebaseapp.com\",\n          databaseURL: \"https://stachka-example.firebaseio.com\",\n          projectId: \"stachka-example\",\n          storageBucket: \"stachka-example.appspot.com\",\n          messagingSenderId: \"907316643379\"\n        });\n      }\n    };\n\n    this.init = function () {\n      if (!firebase.apps.length) {\n        alert(firebase.apps.length);\n        firebase.initializeApp({\n          apiKey: \"AIzaSyCsOjFyAAuFr1CITcnufG-GpZBKpLgUP90\",\n          authDomain: \"rpa999-56929.firebaseapp.com\",\n          databaseURL: \"https://rpa999-56929.firebaseio.com\",\n          projectId: \"rpa999-56929\",\n          storageBucket: \"rpa999-56929.appspot.com\",\n          messagingSenderId: \"155298248089\",\n          appId: \"1:155298248089:web:e25d64dc9f5370c4\"\n        });\n      }\n    };\n\n    this.observeAuth = function () {\n      return firebase.auth().onAuthStateChanged(_this.onAuthStateChanged);\n    };\n\n    this.onAuthStateChanged = function (user) {\n      if (!user) {\n        try {\n          firebase.auth().signInAnonymously();\n        } catch (_ref) {\n          var message = _ref.message;\n          alert(message);\n        }\n      }\n    };\n\n    this.parse = function (snapshot) {\n      console.log(\"line 50\");\n      console.log(snapshot);\n\n      var _snapshot$val = snapshot.val(),\n          numberStamp = _snapshot$val.timestamp,\n          text = _snapshot$val.text,\n          user = _snapshot$val.user;\n\n      var _id = snapshot.key;\n      var timestamp = new Date(numberStamp);\n      var message = {\n        _id: _id,\n        timestamp: timestamp,\n        text: text,\n        user: user,\n        aaaaaaaaa: 1111111111111111111\n      };\n      return message;\n    };\n\n    this.on = function (callback) {\n      return _this.ref.limitToLast(20).on('child_added', function (snapshot) {\n        return callback(_this.parse(snapshot));\n      });\n    };\n\n    this.send = function (messages) {\n      for (var i = 0; i < messages.length; i++) {\n        var _messages$i = messages[i],\n            text = _messages$i.text,\n            user = _messages$i.user;\n        var message = {\n          text: text,\n          user: user,\n          timestamp: _this.timestamp,\n          teset: 1111111111111111111111111111\n        };\n\n        _this.append(message);\n      }\n    };\n\n    this.append = function (message) {\n      return _this.ref.push(message);\n    };\n\n    this.init();\n    this.observeAuth();\n  }\n\n  _createClass(FirebaseStorage, [{\n    key: \"uid\",\n    get: function get() {\n      return (firebase.auth().currentUser || {}).uid;\n    }\n  }, {\n    key: \"ref\",\n    get: function get() {\n      return firebase.database().ref('messages');\n    }\n  }, {\n    key: \"timestamp\",\n    get: function get() {\n      return firebase.database.ServerValue.TIMESTAMP;\n    }\n  }, {\n    key: \"off\",\n    value: function off() {\n      this.ref.off();\n    }\n  }]);\n\n  return FirebaseStorage;\n}();\n\nFirebaseStorage.shared = new FirebaseStorage();\nexport default FirebaseStorage;","map":{"version":3,"sources":["/app/p0005/data/FirebaseStorage.js"],"names":["firebase","FirebaseStorage","initd","apps","length","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","init","alert","appId","observeAuth","auth","onAuthStateChanged","user","signInAnonymously","message","parse","snapshot","console","log","val","numberStamp","timestamp","text","_id","key","Date","aaaaaaaaa","on","callback","ref","limitToLast","send","messages","i","teset","append","push","currentUser","uid","database","ServerValue","TIMESTAMP","off","shared"],"mappings":"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","sourcesContent":["import firebase from 'firebase'; // 4.8.1\n\nclass FirebaseStorage {\n\n  constructor() {\n    this.init();\n    this.observeAuth();\n  }\n\n  initd = () => {\n    if (!firebase.apps.length) {\n        firebase.initializeApp({\n          apiKey: \"AIzaSyDZJZm9TgdBItFu1agAWryuKHWXv8og4pE\",\n          authDomain: \"stachka-example.firebaseapp.com\",\n          databaseURL: \"https://stachka-example.firebaseio.com\",\n          projectId: \"stachka-example\",\n          storageBucket: \"stachka-example.appspot.com\",\n          messagingSenderId: \"907316643379\"\n      });\n    }\n  }\n  init = () => {\n    //alert(firebase.apps.length)\n    if (!firebase.apps.length) {\n      alert(firebase.apps.length)\n        firebase.initializeApp({\n    apiKey: \"AIzaSyCsOjFyAAuFr1CITcnufG-GpZBKpLgUP90\",\n  authDomain: \"rpa999-56929.firebaseapp.com\",\n  databaseURL: \"https://rpa999-56929.firebaseio.com\",\n  projectId: \"rpa999-56929\",\n  storageBucket: \"rpa999-56929.appspot.com\",\n  messagingSenderId: \"155298248089\",\n  appId: \"1:155298248089:web:e25d64dc9f5370c4\"\n   });\n    }\n  }\n\n  observeAuth = () =>\n    firebase.auth().onAuthStateChanged(this.onAuthStateChanged);\n\n  onAuthStateChanged = user => {\n    if (!user) {\n      try {\n        firebase.auth().signInAnonymously();\n      } catch ({ message }) {\n        alert(message);\n      }\n    }\n  };\n\n  get uid() {\n    return (firebase.auth().currentUser || {}).uid;\n  }\n\n  get ref() {\n    return firebase.database().ref('messages');\n  }\n\n  parse = snapshot => {\n    console.log(\"line 50\")\n    console.log(snapshot)\n    let { timestamp: numberStamp, text, user } = snapshot.val();//val text で設定\n    //text = JSON.stringify(snapshot)//text + \"chinko\";\n    const { key: _id } = snapshot;\n    const timestamp = new Date(numberStamp);\n    const message = {\n      _id,\n      timestamp,\n      text,\n      user,\n      aaaaaaaaa:1111111111111111111\n    };\n    return message;\n  };\n\n  on = callback =>\n    this.ref\n      .limitToLast(20)\n      .on('child_added', snapshot => callback(this.parse(snapshot)));\n\n  get timestamp() {\n    return firebase.database.ServerValue.TIMESTAMP;\n  }\n  \n  send = messages => {\n    for (let i = 0; i < messages.length; i++) {\n      const { text, user } = messages[i];\n      const message = {\n        text,\n        user,\n        timestamp: this.timestamp,\n        teset:1111111111111111111111111111\n      };\n      this.append(message);\n    }\n  };\n\n  append = message => this.ref.push(message);\n\n  off() {\n    this.ref.off();\n  }\n}\n\nFirebaseStorage.shared = new FirebaseStorage();\nexport default FirebaseStorage;\n"]},"metadata":{},"sourceType":"module"}