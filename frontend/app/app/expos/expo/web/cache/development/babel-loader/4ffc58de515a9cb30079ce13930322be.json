{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.useTNodeChildrenProps = useTNodeChildrenProps;\nexports.default = void 0;\n\nvar _react = _interopRequireDefault(require(\"react\"));\n\nvar _SharedPropsProvider = require(\"./context/SharedPropsProvider\");\n\nvar _TChildrenRenderer = _interopRequireWildcard(require(\"./TChildrenRenderer\"));\n\nfunction _getRequireWildcardCache(nodeInterop) {\n  if (typeof WeakMap !== \"function\") return null;\n  var cacheBabelInterop = new WeakMap();\n  var cacheNodeInterop = new WeakMap();\n  return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) {\n    return nodeInterop ? cacheNodeInterop : cacheBabelInterop;\n  })(nodeInterop);\n}\n\nfunction _interopRequireWildcard(obj, nodeInterop) {\n  if (!nodeInterop && obj && obj.__esModule) {\n    return obj;\n  }\n\n  if (obj === null || typeof obj !== \"object\" && typeof obj !== \"function\") {\n    return {\n      default: obj\n    };\n  }\n\n  var cache = _getRequireWildcardCache(nodeInterop);\n\n  if (cache && cache.has(obj)) {\n    return cache.get(obj);\n  }\n\n  var newObj = {};\n  var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor;\n\n  for (var key in obj) {\n    if (key !== \"default\" && Object.prototype.hasOwnProperty.call(obj, key)) {\n      var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null;\n\n      if (desc && (desc.get || desc.set)) {\n        Object.defineProperty(newObj, key, desc);\n      } else {\n        newObj[key] = obj[key];\n      }\n    }\n  }\n\n  newObj.default = obj;\n\n  if (cache) {\n    cache.set(obj, newObj);\n  }\n\n  return newObj;\n}\n\nfunction _interopRequireDefault(obj) {\n  return obj && obj.__esModule ? obj : {\n    default: obj\n  };\n}\n\nfunction isCollapsible(tnode) {\n  return tnode.type === 'block' || tnode.type === 'phrasing';\n}\n\nfunction useTNodeChildrenProps(_ref) {\n  var tnode = _ref.tnode,\n      propsForChildren = _ref.propsForChildren,\n      _ref$disableMarginCol = _ref.disableMarginCollapsing,\n      disableMarginCollapsing = _ref$disableMarginCol === void 0 ? false : _ref$disableMarginCol,\n      renderChild = _ref.renderChild;\n\n  var _ref2 = (0, _SharedPropsProvider.useSharedProps)(),\n      enableExperimentalMarginCollapsing = _ref2.enableExperimentalMarginCollapsing;\n\n  var shouldCollapseChildren = enableExperimentalMarginCollapsing && !disableMarginCollapsing && isCollapsible(tnode);\n  return {\n    propsForChildren: propsForChildren,\n    disableMarginCollapsing: !shouldCollapseChildren,\n    tchildren: tnode.children,\n    renderChild: renderChild\n  };\n}\n\nvar TNodeWithChildrenRenderer = function TNodeWithChildrenRenderer(props) {\n  return _react.default.createElement(_TChildrenRenderer.default, useTNodeChildrenProps(props));\n};\n\nfunction TNodeChildrenRenderer(props) {\n  if (props.tnode.type === 'text') {\n    return props.tnode.data;\n  }\n\n  return _react.default.createElement(TNodeWithChildrenRenderer, props);\n}\n\nTNodeChildrenRenderer.defaultProps = _TChildrenRenderer.tchildrenRendererDefaultProps;\nvar _default = TNodeChildrenRenderer;\nexports.default = _default;","map":{"version":3,"sources":["TNodeChildrenRenderer.tsx"],"names":["tnode","disableMarginCollapsing","renderChild","enableExperimentalMarginCollapsing","shouldCollapseChildren","isCollapsible","propsForChildren","tchildren","TNodeWithChildrenRenderer","React","TChildrenRenderer","useTNodeChildrenProps","props","TNodeChildrenRenderer","tchildrenRendererDefaultProps"],"mappings":";;;;;;;;AAAA,IAAA,MAAA,GAAA,sBAAA,CAAA,OAAA,CAAA,OAAA,CAAA,CAAA;;AAEA,IAAA,oBAAA,GAAA,OAAA,iCAAA;;AACA,IAAA,kBAAA,GAAA,uBAAA,CAAA,OAAA,uBAAA,CAAA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAQA,SAAA,aAAA,CAAA,KAAA,EAAqC;AACnC,SAAOA,KAAK,CAALA,IAAAA,KAAAA,OAAAA,IAA0BA,KAAK,CAALA,IAAAA,KAAjC,UAAA;AACD;;AA4BM,SAAA,qBAAA,OAKgD;AAAA,MALjB,KAKiB,QALjB,KAKiB;AAAA,MALjB,gBAKiB,QALjB,gBAKiB;AAAA,mCAFrDC,uBAEqD;AAAA,MAFrDA,uBAEqD,sCALjB,KAKiB;AAAA,MADrDC,WACqD,QADrDA,WACqD;;AACrD,cAA+C,CAAA,GAAA,oBAAA,CAA/C,cAA+C,GAA/C;AAAA,MAAQC,kCAAR,SAAQA,kCAAR;;AACA,MAAMC,sBAAsB,GAC1BD,kCAAkC,IAClC,CADAA,uBAAAA,IAEAE,aAAa,CAHf,KAGe,CAHf;AAIA,SAAO;AACLC,IAAAA,gBADK,EACLA,gBADK;AAELL,IAAAA,uBAAuB,EAAE,CAFpB,sBAAA;AAGLM,IAAAA,SAAS,EAAEP,KAAK,CAHX,QAAA;AAILE,IAAAA,WAAAA,EAAAA;AAJK,GAAP;AAMD;;AAED,IAAMM,yBAAyB,GAAG,SAAA,yBAAA,CAAA,KAAA,EAEhC;AACA,SAAOC,MAAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAoBC,kBAAAA,CAApBD,OAAAA,EAAuCE,qBAAqB,CAAnE,KAAmE,CAA5DF,CAAP;AAHF,CAAA;;AASA,SAAA,qBAAA,CAAA,KAAA,EAEgB;AACd,MAAIG,KAAK,CAALA,KAAAA,CAAAA,IAAAA,KAAJ,MAAA,EAAiC;AAE/B,WAAOA,KAAK,CAALA,KAAAA,CAAP,IAAA;AACD;;AACD,SAAOH,MAAAA,CAAAA,OAAAA,CAAAA,aAAAA,CAAAA,yBAAAA,EAAP,KAAOA,CAAP;AACD;;AAKDI,qBAAqB,CAArBA,YAAAA,GAAqCC,kBAAAA,CAArCD,6BAAAA;eAEeA,qB","sourcesContent":["import React, { ReactElement } from 'react';\nimport { TNode } from '@native-html/transient-render-engine';\nimport { useSharedProps } from './context/SharedPropsProvider';\nimport TChildrenRenderer, {\n  tchildrenRendererDefaultProps\n} from './TChildrenRenderer';\nimport {\n  TChildrenRendererProps,\n  TNodeChildrenRendererProps\n} from './shared-types';\n\nfunction isCollapsible(tnode: TNode) {\n  return tnode.type === 'block' || tnode.type === 'phrasing';\n}\n\n/**\n * A hook especially useful when one need to tamper with children in a custom\n * renderer. Should be used with {@link TChildrenRenderer}.\n *\n * @example\n * For example, a custom renderer which inserts ads in an article:\n *\n * ```tsx\n * function ArticleRenderer(props) {\n *   const { tnode, TDefaultRenderer, ...defaultRendererProps } = props;\n *   const tchildrenProps = useTNodeChildrenProps(props);\n *   const firstChildrenChunk = tnode.children.slice(0, 2);\n *   const secondChildrenChunk = tnode.children.slice(2, 4);\n *   const thirdChildrenChunk = tnode.children.slice(4, 5);\n *   return (\n *     <TDefaultRenderer tnode={tnode} {...defaultRendererProps}>\n *       <TChildrenRenderer {...tchildrenProps} tchildren={firstChildrenChunk} />\n *       {firstChildrenChunk.length === 2 ? <AdComponent /> : null}\n *       <TChildrenRenderer {...tchildrenProps} tchildren={secondChildrenChunk} />\n *       {secondChildrenChunk.length === 2 ? <AdComponent /> : null}\n *       <TChildrenRenderer {...tchildrenProps} tchildren={thirdChildrenChunk} />\n *     </TDefaultRenderer>\n *   );\n * };\n * ```\n */\nexport function useTNodeChildrenProps({\n  tnode,\n  propsForChildren,\n  disableMarginCollapsing = false,\n  renderChild\n}: TNodeChildrenRendererProps): TChildrenRendererProps {\n  const { enableExperimentalMarginCollapsing } = useSharedProps();\n  const shouldCollapseChildren =\n    enableExperimentalMarginCollapsing &&\n    !disableMarginCollapsing &&\n    isCollapsible(tnode);\n  return {\n    propsForChildren,\n    disableMarginCollapsing: !shouldCollapseChildren,\n    tchildren: tnode.children,\n    renderChild\n  };\n}\n\nconst TNodeWithChildrenRenderer = function TNodeWithChildrenRenderer(\n  props: TNodeChildrenRendererProps\n) {\n  return React.createElement(TChildrenRenderer, useTNodeChildrenProps(props));\n};\n\n/**\n * A component to render all children of a {@link TNode}.\n */\nfunction TNodeChildrenRenderer(\n  props: TNodeChildrenRendererProps\n): ReactElement {\n  if (props.tnode.type === 'text') {\n    // see https://github.com/DefinitelyTyped/DefinitelyTyped/issues/20544\n    return props.tnode.data as unknown as ReactElement;\n  }\n  return React.createElement(TNodeWithChildrenRenderer, props);\n}\n\n/**\n * @ignore\n */\nTNodeChildrenRenderer.defaultProps = tchildrenRendererDefaultProps;\n\nexport default TNodeChildrenRenderer;\n"]},"metadata":{},"sourceType":"script"}