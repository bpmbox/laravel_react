{"ast":null,"code":"import _classCallCheck from \"@babel/runtime/helpers/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/createClass\";\nimport firebase from 'firebase';\n\nvar FirebaseStorage = function () {\n  function FirebaseStorage() {\n    var _this = this;\n\n    _classCallCheck(this, FirebaseStorage);\n\n    this.initd = function () {\n      if (!firebase.apps.length) {\n        firebase.initializeApp({\n          apiKey: \"AIzaSyDZJZm9TgdBItFu1agAWryuKHWXv8og4pE\",\n          authDomain: \"stachka-example.firebaseapp.com\",\n          databaseURL: \"https://stachka-example.firebaseio.com\",\n          projectId: \"stachka-example\",\n          storageBucket: \"stachka-example.appspot.com\",\n          messagingSenderId: \"907316643379\"\n        });\n      }\n    };\n\n    this.init = function () {\n      if (!firebase.apps.length) {\n        alert(firebase.apps.length);\n        firebase.initializeApp({\n          apiKey: \"AIzaSyCsOjFyAAuFr1CITcnufG-GpZBKpLgUP90\",\n          authDomain: \"rpa999-56929.firebaseapp.com\",\n          databaseURL: \"https://rpa999-56929.firebaseio.com\",\n          projectId: \"rpa999-56929\",\n          storageBucket: \"rpa999-56929.appspot.com\",\n          messagingSenderId: \"155298248089\",\n          appId: \"1:155298248089:web:e25d64dc9f5370c4\"\n        });\n      }\n    };\n\n    this.observeAuth = function () {\n      return firebase.auth().onAuthStateChanged(_this.onAuthStateChanged);\n    };\n\n    this.onAuthStateChanged = function (user) {\n      if (!user) {\n        try {\n          firebase.auth().signInAnonymously();\n        } catch (_ref) {\n          var message = _ref.message;\n          alert(message);\n        }\n      }\n    };\n\n    this.parse = function (snapshot) {\n      console.log(\"line 50\");\n      console.log(snapshot);\n      google.script.run.withSuccessHandler(function (message) {\n        spflg = message;\n      }).withFailureHandler(function (msg, element) {\n        showStatus(msg, 'error');\n        element.disabled = false;\n      }).withUserObject(_this).myFunction2();\n      var _id = snapshot.key;\n      var timestamp = new Date(numberStamp);\n      var message = {\n        _id: _id,\n        timestamp: timestamp,\n        text: text,\n        user: user,\n        aaaaaaaaa: 1111111111111111111\n      };\n      return message;\n    };\n\n    this.on = function (callback) {\n      return _this.ref.limitToLast(20).on('child_added', function (snapshot) {\n        return callback(_this.parse(snapshot));\n      });\n    };\n\n    this.send = function (messages) {\n      for (var i = 0; i < messages.length; i++) {\n        var _messages$i = messages[i],\n            _text = _messages$i.text,\n            _user = _messages$i.user;\n        var message = {\n          text: _text,\n          user: _user,\n          timestamp: _this.timestamp,\n          teset: 1111111111111111111111111111\n        };\n\n        _this.append(message);\n      }\n    };\n\n    this.append = function (message) {\n      return _this.ref.push(message);\n    };\n\n    this.init();\n    this.observeAuth();\n  }\n\n  _createClass(FirebaseStorage, [{\n    key: \"uid\",\n    get: function get() {\n      return (firebase.auth().currentUser || {}).uid;\n    }\n  }, {\n    key: \"ref\",\n    get: function get() {\n      return firebase.database().ref('messages');\n    }\n  }, {\n    key: \"timestamp\",\n    get: function get() {\n      return firebase.database.ServerValue.TIMESTAMP;\n    }\n  }, {\n    key: \"off\",\n    value: function off() {\n      this.ref.off();\n    }\n  }]);\n\n  return FirebaseStorage;\n}();\n\nFirebaseStorage.shared = new FirebaseStorage();\nexport default FirebaseStorage;","map":{"version":3,"sources":["/app/p0005/data/FirebaseStorage.js"],"names":["firebase","FirebaseStorage","initd","apps","length","initializeApp","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","init","alert","appId","observeAuth","auth","onAuthStateChanged","user","signInAnonymously","message","parse","snapshot","console","log","google","script","run","withSuccessHandler","spflg","withFailureHandler","msg","element","showStatus","disabled","withUserObject","myFunction2","_id","key","timestamp","Date","numberStamp","text","aaaaaaaaa","on","callback","ref","limitToLast","send","messages","i","teset","append","push","currentUser","uid","database","ServerValue","TIMESTAMP","off","shared"],"mappings":"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","sourcesContent":["import firebase from 'firebase'; // 4.8.1\n\nclass FirebaseStorage {\n\n  constructor() {\n    this.init();\n    this.observeAuth();\n  }\n\n  initd = () => {\n    if (!firebase.apps.length) {\n      firebase.initializeApp({\n        apiKey: \"AIzaSyDZJZm9TgdBItFu1agAWryuKHWXv8og4pE\",\n        authDomain: \"stachka-example.firebaseapp.com\",\n        databaseURL: \"https://stachka-example.firebaseio.com\",\n        projectId: \"stachka-example\",\n        storageBucket: \"stachka-example.appspot.com\",\n        messagingSenderId: \"907316643379\"\n      });\n    }\n  }\n  init = () => {\n    //alert(firebase.apps.length)\n    if (!firebase.apps.length) {\n      alert(firebase.apps.length)\n      firebase.initializeApp({\n        apiKey: \"AIzaSyCsOjFyAAuFr1CITcnufG-GpZBKpLgUP90\",\n        authDomain: \"rpa999-56929.firebaseapp.com\",\n        databaseURL: \"https://rpa999-56929.firebaseio.com\",\n        projectId: \"rpa999-56929\",\n        storageBucket: \"rpa999-56929.appspot.com\",\n        messagingSenderId: \"155298248089\",\n        appId: \"1:155298248089:web:e25d64dc9f5370c4\"\n      });\n    }\n  }\n\n  observeAuth = () =>\n    firebase.auth().onAuthStateChanged(this.onAuthStateChanged);\n\n  onAuthStateChanged = user => {\n    if (!user) {\n      try {\n        firebase.auth().signInAnonymously();\n      } catch ({ message }) {\n        alert(message);\n      }\n    }\n  };\n\n  get uid() {\n    return (firebase.auth().currentUser || {}).uid;\n  }\n\n  get ref() {\n    return firebase.database().ref('messages');\n  }\n\n  parse = snapshot => {\n    console.log(\"line 50\")\n    console.log(snapshot)\n    //GASよびだし\n    google.script.run\n      .withSuccessHandler(\n        //無名関数にデータを入れる\n        function (message) {\n          // Respond to success conditions here.\n          //showStatus('Cell set to reference value: ' + value);\n          // element.disabled = false;\n          spflg = message\n          //Logger.log(message)\n          //alert(message)\n          //speechSynthesis.speak(msg);\n        })\n      .withFailureHandler(\n        function (msg, element) {\n          // Respond to failure conditions here.\n          showStatus(msg, 'error');\n          element.disabled = false;\n        })\n      .withUserObject(this)\n      .myFunction2();\n\n    //text = JSON.stringify(snapshot)//text + \"chinko\";\n    const { key: _id } = snapshot;\n    const timestamp = new Date(numberStamp);\n    const message = {\n      _id,\n      timestamp,\n      text,\n      user,\n      aaaaaaaaa: 1111111111111111111\n    };\n    return message;\n  };\n\n  on = callback =>\n    this.ref\n      .limitToLast(20)\n      .on('child_added', snapshot => callback(this.parse(snapshot)));\n\n  get timestamp() {\n    return firebase.database.ServerValue.TIMESTAMP;\n  }\n\n  send = messages => {\n    for (let i = 0; i < messages.length; i++) {\n      const { text, user } = messages[i];\n      const message = {\n        text,\n        user,\n        timestamp: this.timestamp,\n        teset: 1111111111111111111111111111\n      };\n      this.append(message);\n    }\n  };\n\n  append = message => this.ref.push(message);\n\n  off() {\n    this.ref.off();\n  }\n}\n\nFirebaseStorage.shared = new FirebaseStorage();\nexport default FirebaseStorage;\n"]},"metadata":{},"sourceType":"module"}