<!DOCTYPE html>
<html>
  <head>
    <base target="_top">
    <!-- Use a templated HTML printing scriptlet to import common stylesheet -->
    <?!= HtmlService.createHtmlOutputFromFile('Stylesheet').getContent(); ?>
  </head>
  <body>
  
    <!-- Below is the HTML code that defines the sidebar element structure. -->
    <div class="sidebar branding-below">
    <a href="https://dev.bpmboxes.com/sysworkflow/en/neoclassic/9635095775a1701fcd8c2a4010874341/3629020315a36cea971e988095272522.php" target=_blunk>登録画面作成はこちら</a></br>
       <a href="https://chrome.google.com/webstore/detail/iframe-allow/gifgpciglhhpmeefjdmlpboipkibhbjg" target=_blunk>CHROME IFRAM インストール</a>
      <a href="https://www.bpmchat.com/" target=_blunk>GOOGLESITE BPMBOXES説明</a>
      <p>
      音声でフォーカスのあったセルに</br>登録します</br></br>
      セレクトボックスで対応のシートを</br>選択してください</br>
        <? 
//        var data = SpreadsheetApp
//.getActiveSpreadsheet().getSheetByName('Sheet16').getDataRange()
//.getValues(); 
?>
<!-- セレクトボックス　スタート /-->
<select name='alphabet'>
<?
//output.append(e.parameter.p1);
function PutLinks()
{
  // スプレッドシート内の全シートとスプレッドシートのID
  var sheets = SpreadsheetApp.getActive().getSheets();
  var ssId = SpreadsheetApp.getActive().getId();

  // ハイパーリンク文字列の配列
  var linkList = [[]];

  for(var i=0; i<sheets.length; i++) {
    // シートのIDと名前
    var sheetId = sheets[i].getSheetId();
    var sheetName = sheets[i].getSheetName();
    output.append('<option value="'+sheetName+'">'+sheetName+"</option>") 
//<option value="mercedes">Mercedes</option>
    // シートのURLからハイパーリンク文字列を組み立て
    var url = "https://docs.google.com/spreadsheets/d/" + ssId + "/edit#gid=" + sheetId;
    var link = [ '=HYPERLINK("' + url + '","' + sheetName + '")' ];

    // ハイパーリンク文字列を配列に格納
    linkList[i] = link;
  }

  // 選択中のセルにハイパーリンク文字列を入れる
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var cell = sheet.getActiveCell();
  var range = sheet.getRange(cell.getRow() , cell.getColumn() ,  linkList.length , 1);
  //range.setValues(linkList);
}
PutLinks()
?>
</select>
<!-- セレクトボックス　スタート /-->
<? //for (var i = 0; i < data.length; i++) { ?>
<? //if(data[i][0]){ ?>

<? //for (var j = 0; j < data[i].length; j++) { ?>
<? //output.append(data[i][j])  ?>
<? //} ?>

<? //} ?>
<? //} ?>

      </p>
      
       <div class="block form-group" id="chatroomid">
        <label for="sidebar-value">TEXTEDITER</label>
        <!--<input id="sidebar-value" value="1">-->
        <textarea id="text_edit" placeholder="テキストエディター..." value="word"></textarea>
      </div>
    
    
      <div class="block form-group" id="sidebar-value-block">
        <label for="sidebar-value">作業番号:</label>
        <!--<input id="sidebar-value" value="1">-->
        <textarea id="sidebar-seq" placeholder="作業番号..." value="word"></textarea>
      </div>
       
       <div class="block" id="sidebar-value-block">
       <label for="sidebar-value">作業:</label>
       <div>
        <button id="createCase">作業登録</button>
        <button id="sendVariables">作業更新</button>
       <button id="getVariables">作業取得</button>
       
        </div>
      </div>
       <div id="sidebar-status"></div>
        <a href="https://chat.bpmboxes.com/phprunner/PMT_SPREADMAIN_list.php" target=_blunk>登録データの確認はこちら</a></br>
         <a href="https://dev.bpmboxes.com/sysworkflow/en/neoclassic/cases/main" target=_blunk>BPMSでの業務ナビゲートはこちら</a></br>
       <!--
       <div class="block form-group" id="sidebar-value-block">
        <label for="sidebar-value">メールTO:</label>
        <input id="sidebar-value" value="1">
        <textarea id="sidebar-seq" placeholder="メールTO..." value="word"></textarea>
      </div>
       <div class="block form-group" id="sidebar-value-block">
        <label for="sidebar-value">メールFROM:</label>
        <input id="sidebar-value" value="1">
        <textarea id="sidebar-seq" placeholder="メールFROM..." value="word"></textarea>
      </div>
      /-->
      <div class="block form-group" id="sidebar-value-block">
        <label for="sidebar-value">音声:サジェスト機能の追加予定</label>
        <!--<input id="sidebar-value" value="1">-->
        <textarea id="sidebar-value" placeholder="Message..." value="word"></textarea>
        <textarea id="status" placeholder="Message..." value=""></textarea>
      </div>
      <!--
      <div class="block" id="sidebar-button-bar">
        <button id="sidebar-pull-button">データ取得</button>
        <button id="sidebar-put-button">データ登録</button>
      </div>
      <div class="block" id="sidebar-button-bar">
      チャットワークにも送信しますがS列以上のデータがある場合エラーとなります
        <button id="sidebar-dataup-buttonup">スプレッドシートをデータベースに登録</button>
      </div>
      <div class="block" id="sidebar-button-bar">
        <button id="sidebar-dataup-buttondown">データベースからスプレッドシートに取得</button>
      </div>
      <div class="block" id="sidebar-button-bar_mail">
        <button id="sidebar-dataup-button">スプレッドシートの内容をメール送信</button>
      </div>
      /-->
      <div class="block" id="sidebar-value-block">
       <!-- セレクトボックス　スタート /-->
<select name='QAsheet'>
<?
//output.append(e.parameter.p1);
function PutLinks()
{
  // スプレッドシート内の全シートとスプレッドシートのID
  var sheets = SpreadsheetApp.getActive().getSheets();
  var ssId = SpreadsheetApp.getActive().getId();

  // ハイパーリンク文字列の配列
  var linkList = [[]];

  for(var i=0; i<sheets.length; i++) {
    // シートのIDと名前
    var sheetId = sheets[i].getSheetId();
    var sheetName = sheets[i].getSheetName();
    output.append('<option value="'+sheetName+'">'+sheetName+"</option>") 
//<option value="mercedes">Mercedes</option>
    // シートのURLからハイパーリンク文字列を組み立て
    var url = "https://docs.google.com/spreadsheets/d/" + ssId + "/edit#gid=" + sheetId;
    var link = [ '=HYPERLINK("' + url + '","' + sheetName + '")' ];

    // ハイパーリンク文字列を配列に格納
    linkList[i] = link;
  }

  // 選択中のセルにハイパーリンク文字列を入れる
  var sheet = SpreadsheetApp.getActiveSpreadsheet().getActiveSheet();
  var cell = sheet.getActiveCell();
  var range = sheet.getRange(cell.getRow() , cell.getColumn() ,  linkList.length , 1);
  //range.setValues(linkList);
}
PutLinks()
?>
</select>
      <div class="block form-group" id="chatkey">
        <label for="sidebar-value">チャットワークキー</label>
        <!--<input id="sidebar-value" value="1">-->
        <textarea id="chat-key" placeholder="キー..." value="word"></textarea>
      </div>
       <div class="block form-group" id="chatroomid">
        <label for="sidebar-value">ルームID</label>
        <!--<input id="sidebar-value" value="1">-->
        <textarea id="chat-roomid" placeholder="ルームID..." value="word"></textarea>
      </div>
      <div></div>
      </div>
      <div class="block" id="sidebar-dataup-chatwork">
        <button id="sidebar-dataup-chatwork">チャットワーク設定</button>
      </div>
      <div class="block" id="sidebar-button-send">
        <button id="sidebar-send-chatwork">チャットワークへ送信</button>
      </div>
  
<!-- セレクトボックス　スタート /-->
  
    </div>

    <!-- Enter sidebar bottom-branding below. -->
    <div class="sidebar bottom">
      <img alt="Add-on logo" class="logo" width="25"
          src="https://googledrive.com/host/0B0G1UdyJGrY6XzdjQWF4a1JYY1k/apps-script_2x.png">
      <span class="gray branding-text">Spreadsheet Add-on Template by Google</span>
    </div>

    <!-- Use a templated HTML printing scriptlet to import JavaScript. -->
    <?!= HtmlService.createHtmlOutputFromFile('SidebarJavaScript').getContent(); ?>
  </body>
</html>
