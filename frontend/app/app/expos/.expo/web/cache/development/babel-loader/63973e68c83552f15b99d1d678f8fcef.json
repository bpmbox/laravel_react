{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nvar _jsxFileName = \"/app/examples/11-news/WorldwideNews.js\";\nimport React, { useState, useEffect, useRef } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport SafeAreaView from \"react-native-web/dist/exports/SafeAreaView\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport FlatList from \"react-native-web/dist/exports/FlatList\";\nimport ActivityIndicator from \"react-native-web/dist/exports/ActivityIndicator\";\nimport Constants from \"expo-constants\";\nimport { uniqBy } from \"lodash\";\nimport { getNews } from \"./apis\";\nimport Article from \"./Article\";\nvar PAGE_SIZE = 20;\nvar PRIMARY_COLOR = \"#e74c3c\";\nexport default function WorldwideNews() {\n  var _this = this;\n\n  var _useState = useState(true),\n      _useState2 = _slicedToArray(_useState, 2),\n      isLoading = _useState2[0],\n      setLoading = _useState2[1];\n\n  var _useState3 = useState([]),\n      _useState4 = _slicedToArray(_useState3, 2),\n      articles = _useState4[0],\n      setArticles = _useState4[1];\n\n  var _useState5 = useState(1),\n      _useState6 = _slicedToArray(_useState5, 2),\n      page = _useState6[0],\n      setPage = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      refreshing = _useState8[0],\n      setRefreshing = _useState8[1];\n\n  var hasMoreData = useRef(true);\n  useEffect(function () {\n    var fetchData = function fetchData() {\n      var newArticles;\n      return _regeneratorRuntime.async(function fetchData$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              if (hasMoreData.current) {\n                _context.next = 2;\n                break;\n              }\n\n              return _context.abrupt(\"return\");\n\n            case 2:\n              _context.next = 4;\n              return _regeneratorRuntime.awrap(getNews(page, PAGE_SIZE));\n\n            case 4:\n              newArticles = _context.sent;\n\n              if (newArticles.length < PAGE_SIZE) {\n                hasMoreData.current = false;\n              }\n\n              setArticles(function (articles) {\n                var allArticles = articles.concat(newArticles.filter(function (article) {\n                  return article.urlToImage;\n                }));\n                return uniqBy(allArticles, \"url\");\n              });\n              setLoading(false);\n              setRefreshing(false);\n\n            case 9:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, null, null, null, Promise);\n    };\n\n    fetchData();\n  }, [page]);\n\n  var refreshData = function refreshData() {\n    setPage(1);\n    setRefreshing(true);\n    setArticles([]);\n    hasMoreData.current = true;\n  };\n\n  var renderArticle = function renderArticle(_ref) {\n    var item = _ref.item;\n    return React.createElement(Article, {\n      item: item,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 59,\n        columnNumber: 39\n      }\n    });\n  };\n\n  var renderDivider = function renderDivider() {\n    return React.createElement(View, {\n      style: styles.articleSeparator,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 60,\n        columnNumber: 31\n      }\n    });\n  };\n\n  var renderFooter = function renderFooter() {\n    return React.createElement(View, {\n      style: styles.center,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62,\n        columnNumber: 5\n      }\n    }, hasMoreData.current && React.createElement(ActivityIndicator, {\n      color: PRIMARY_COLOR,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 31\n      }\n    }));\n  };\n\n  var keyExtractor = function keyExtractor(item) {\n    return item.url;\n  };\n\n  return React.createElement(SafeAreaView, {\n    style: styles.container,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69,\n      columnNumber: 5\n    }\n  }, React.createElement(View, {\n    style: styles.content,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }\n  }, React.createElement(Text, {\n    style: styles.headlines,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71,\n      columnNumber: 9\n    }\n  }, \"Worldwide News\"), isLoading ? React.createElement(View, {\n    style: styles.center,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74,\n      columnNumber: 11\n    }\n  }, React.createElement(ActivityIndicator, {\n    size: \"large\",\n    color: PRIMARY_COLOR,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 76,\n      columnNumber: 13\n    }\n  })) : React.createElement(FlatList, {\n    data: articles,\n    renderItem: renderArticle,\n    keyExtractor: keyExtractor,\n    showsVerticalScrollIndicator: false,\n    ItemSeparatorComponent: renderDivider,\n    ListFooterComponent: renderFooter,\n    initialNumToRender: 6,\n    onEndReached: function onEndReached() {\n      return setPage(function (page) {\n        return page + 1;\n      });\n    },\n    onEndReachedThreshold: 1,\n    onRefresh: refreshData,\n    refreshing: refreshing,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 11\n    }\n  })));\n}\nvar styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    paddingTop: Constants.statusBarHeight\n  },\n  content: {\n    flex: 1,\n    padding: 15\n  },\n  center: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\"\n  },\n  headlines: {\n    fontSize: 32,\n    fontWeight: \"bold\",\n    lineHeight: 50,\n    color: PRIMARY_COLOR\n  },\n  articleSeparator: {\n    borderBottomWidth: 1,\n    borderBottomColor: \"#ed7669\"\n  }\n});","map":{"version":3,"sources":["/app/examples/11-news/WorldwideNews.js"],"names":["React","useState","useEffect","useRef","Constants","uniqBy","getNews","Article","PAGE_SIZE","PRIMARY_COLOR","WorldwideNews","isLoading","setLoading","articles","setArticles","page","setPage","refreshing","setRefreshing","hasMoreData","fetchData","current","newArticles","length","allArticles","concat","filter","article","urlToImage","refreshData","renderArticle","item","renderDivider","styles","articleSeparator","renderFooter","center","keyExtractor","url","container","content","headlines","StyleSheet","create","flex","paddingTop","statusBarHeight","padding","justifyContent","alignItems","fontSize","fontWeight","lineHeight","color","borderBottomWidth","borderBottomColor"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef } from \"react\";\nimport {\n  StyleSheet,\n  SafeAreaView,\n  View,\n  Text,\n  FlatList,\n  ActivityIndicator,\n} from \"react-native\";\nimport Constants from \"expo-constants\";\nimport { uniqBy } from \"lodash\";\nimport { getNews } from \"./apis\";\nimport Article from \"./Article\";\n\nconst PAGE_SIZE = 20;\nconst PRIMARY_COLOR = \"#e74c3c\";\n\nexport default function WorldwideNews() {\n  const [isLoading, setLoading] = useState(true);\n  const [articles, setArticles] = useState([]);\n  const [page, setPage] = useState(1);\n  const [refreshing, setRefreshing] = useState(false);\n  const hasMoreData = useRef(true);\n\n  useEffect(() => {\n    const fetchData = async () => {\n      if (!hasMoreData.current) return;\n\n      const newArticles = await getNews(page, PAGE_SIZE);\n\n      if (newArticles.length < PAGE_SIZE) {\n        hasMoreData.current = false;\n      }\n\n      setArticles((articles) => {\n        // Combine and filter article has no image\n        const allArticles = articles.concat(\n          newArticles.filter((article) => article.urlToImage)\n        );\n\n        // Remove duplicate articles\n        // https://lodash.com/docs/4.17.15#uniqBy\n        return uniqBy(allArticles, \"url\");\n      });\n      setLoading(false);\n      setRefreshing(false);\n    };\n\n    fetchData();\n  }, [page]);\n\n  const refreshData = () => {\n    setPage(1);\n    setRefreshing(true);\n    setArticles([]);\n    hasMoreData.current = true;\n  };\n\n  const renderArticle = ({ item }) => <Article item={item} />;\n  const renderDivider = () => <View style={styles.articleSeparator}></View>;\n  const renderFooter = () => (\n    <View style={styles.center}>\n      {hasMoreData.current && <ActivityIndicator color={PRIMARY_COLOR} />}\n    </View>\n  );\n  const keyExtractor = (item) => item.url;\n\n  return (\n    <SafeAreaView style={styles.container}>\n      <View style={styles.content}>\n        <Text style={styles.headlines}>Worldwide News</Text>\n\n        {isLoading ? (\n          <View style={styles.center}>\n            {/* https://reactnative.dev/docs/activityindicator */}\n            <ActivityIndicator size=\"large\" color={PRIMARY_COLOR} />\n          </View>\n        ) : (\n          // Optimizing FlatList: https://reactnative.dev/docs/optimizing-flatlist-configuration\n          <FlatList\n            data={articles}\n            renderItem={renderArticle}\n            keyExtractor={keyExtractor}\n            showsVerticalScrollIndicator={false}\n            ItemSeparatorComponent={renderDivider}\n            ListFooterComponent={renderFooter}\n            initialNumToRender={6}\n            onEndReached={() => setPage((page) => page + 1)}\n            onEndReachedThreshold={1}\n            onRefresh={refreshData}\n            refreshing={refreshing}\n          />\n        )}\n      </View>\n    </SafeAreaView>\n  );\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    paddingTop: Constants.statusBarHeight,\n  },\n  content: {\n    flex: 1,\n    padding: 15,\n  },\n  center: {\n    flex: 1,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n  },\n  headlines: {\n    fontSize: 32,\n    fontWeight: \"bold\",\n    lineHeight: 50,\n    color: PRIMARY_COLOR,\n  },\n  articleSeparator: {\n    borderBottomWidth: 1,\n    borderBottomColor: \"#ed7669\",\n  },\n});\n"]},"metadata":{},"sourceType":"module"}